
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>PyLOSt.ui.hdf5widget_custom &#8212; PyLOSt  documentation</title>
    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/alabaster.css" />
    <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/jquery.js"></script>
    <script src="../../../_static/underscore.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
   
  <link rel="stylesheet" href="../../../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <h1>Source code for PyLOSt.ui.hdf5widget_custom</h1><div class="highlight"><pre>
<span></span><span class="ch">#!/usr/bin/env python</span>
<span class="c1"># coding: utf-8</span>
<span class="c1"># /*##########################################################################</span>
<span class="c1">#</span>
<span class="c1"># Copyright (c) 2016-2018 European Synchrotron Radiation Facility</span>
<span class="c1">#</span>
<span class="c1"># Permission is hereby granted, free of charge, to any person obtaining a copy</span>
<span class="c1"># of this software and associated documentation files (the &quot;Software&quot;), to deal</span>
<span class="c1"># in the Software without restriction, including without limitation the rights</span>
<span class="c1"># to use, copy, modify, merge, publish, distribute, sublicense, and/or sell</span>
<span class="c1"># copies of the Software, and to permit persons to whom the Software is</span>
<span class="c1"># furnished to do so, subject to the following conditions:</span>
<span class="c1">#</span>
<span class="c1"># The above copyright notice and this permission notice shall be included in</span>
<span class="c1"># all copies or substantial portions of the Software.</span>
<span class="c1">#</span>
<span class="c1"># THE SOFTWARE IS PROVIDED &quot;AS IS&quot;, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR</span>
<span class="c1"># IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,</span>
<span class="c1"># FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE</span>
<span class="c1"># AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER</span>
<span class="c1"># LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,</span>
<span class="c1"># OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN</span>
<span class="c1"># THE SOFTWARE.</span>
<span class="c1">#</span>
<span class="c1"># ###########################################################################*/</span>
<span class="kn">import</span> <span class="nn">h5py</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">scipy</span>
<span class="kn">from</span> <span class="nn">silx.gui.colors</span> <span class="kn">import</span> <span class="n">Colormap</span>

<span class="kn">from</span> <span class="nn">PyLOSt.data_in.fizeau.datx.read_datx</span> <span class="kn">import</span> <span class="n">readDatxFile</span>
<span class="kn">from</span> <span class="nn">PyLOSt.data_in.fizeau.read_dat</span> <span class="kn">import</span> <span class="n">readDatFile</span>
<span class="kn">from</span> <span class="nn">PyLOSt.data_in.msi.read_opd</span> <span class="kn">import</span> <span class="n">Read_opd_file</span>
<span class="kn">from</span> <span class="nn">PyLOSt.ui.stitch_algorithms.global_optimization_fast</span> <span class="kn">import</span> <span class="n">GlobalOptimizationFast</span>
<span class="kn">from</span> <span class="nn">PyLOSt.ui.stitch_algorithms.matrix_overlaperr_stitch_fast</span> <span class="kn">import</span> <span class="n">MatrixOverlapErrStitchFast</span>
<span class="kn">from</span> <span class="nn">PyLOSt.ui.stitch_algorithms.progressive_stitch</span> <span class="kn">import</span> <span class="n">ProgressiveStitch</span>
<span class="kn">from</span> <span class="nn">PyQt5.QtWidgets</span> <span class="kn">import</span> <span class="n">QPushButton</span><span class="p">,</span> <span class="n">QLineEdit</span><span class="p">,</span> <span class="n">QRadioButton</span><span class="p">,</span> <span class="n">QFileDialog</span>

<span class="kn">from</span> <span class="nn">PyLOSt.ui.settings.SGEditMetaData</span> <span class="kn">import</span> <span class="n">SGEditMetaData</span>
<span class="kn">from</span> <span class="nn">PyLOSt.ui.settings.SGNewStitchSetup</span> <span class="kn">import</span> <span class="n">SGNewStitchSetup</span>
<span class="kn">from</span> <span class="nn">silx.gui.plot.PlotWindow</span> <span class="kn">import</span> <span class="n">Plot2D</span><span class="p">,</span> <span class="n">Plot1D</span>
<span class="kn">from</span> <span class="nn">PyLOSt.ui.stitch_algorithms.util.util_stitching</span> <span class="kn">import</span> <span class="n">avgStitchedScans</span><span class="p">,</span> <span class="n">getStd</span><span class="p">,</span> <span class="n">gravity_correction</span>
<span class="kn">from</span> <span class="nn">PyLOSt.algorithms.util.util_fit</span> <span class="kn">import</span> <span class="n">fit1D</span><span class="p">,</span> <span class="n">fit2D</span><span class="p">,</span> <span class="n">getPixSz2D</span>
<span class="kn">from</span> <span class="nn">PyLOSt.algorithms.util.util_math</span> <span class="kn">import</span> <span class="n">rms</span>

<span class="kn">from</span> <span class="nn">silx.gui.data.DataViews</span> <span class="kn">import</span> <span class="n">IMAGE_MODE</span>
<span class="kn">from</span> <span class="nn">PyLOSt.ui.simulations.SGSimulations</span> <span class="kn">import</span> <span class="n">SGSimulations</span>
<span class="kn">from</span> <span class="nn">PyLOSt.ui.stitch_algorithms.util.remove_best_ellipse</span> <span class="kn">import</span> <span class="n">remEllipseData</span><span class="p">,</span> <span class="n">remEllipseLine</span>
<span class="kn">from</span> <span class="nn">scipy.ndimage.interpolation</span> <span class="kn">import</span> <span class="n">shift</span>
<span class="kn">from</span> <span class="nn">PyLOSt.ui.stitch_algorithms.util</span> <span class="kn">import</span> <span class="n">slp2hgt</span>
<span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">integrate</span>

<span class="sd">&quot;&quot;&quot;Qt Hdf5 widget examples</span>

<span class="sd">.. note:: This module has a dependency on the `h5py &lt;http://www.h5py.org/&gt;`_</span>
<span class="sd">    library, which is not a mandatory dependency for `silx`. You might need</span>
<span class="sd">    to install it if you don&#39;t already have it.</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="kn">import</span> <span class="nn">logging</span>
<span class="kn">import</span> <span class="nn">sys</span>

<span class="n">logging</span><span class="o">.</span><span class="n">basicConfig</span><span class="p">()</span>
<span class="n">_logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="s2">&quot;hdf5widget&quot;</span><span class="p">)</span>
<span class="sd">&quot;&quot;&quot;Module logger&quot;&quot;&quot;</span>

<span class="c1"># try:</span>
<span class="c1">#     # it should be loaded before h5py</span>
<span class="c1">#     import hdf5plugin  # noqa</span>
<span class="c1"># except ImportError:</span>
<span class="c1">#     message = &quot;Module &#39;hdf5plugin&#39; is not installed. It supports some hdf5&quot;\</span>
<span class="c1">#         + &quot; compressions. You can install it using \&quot;pip install hdf5plugin\&quot;.&quot;</span>
<span class="c1">#     _logger.warning(message)</span>
<span class="c1"># import h5py</span>

<span class="kn">import</span> <span class="nn">silx.gui.hdf5</span>
<span class="kn">import</span> <span class="nn">silx.utils.html</span>
<span class="kn">from</span> <span class="nn">silx.gui</span> <span class="kn">import</span> <span class="n">qt</span>
<span class="kn">from</span> <span class="nn">silx.gui.data.DataViewerFrame</span> <span class="kn">import</span> <span class="n">DataViewerFrame</span>

<span class="k">try</span><span class="p">:</span>
    <span class="kn">import</span> <span class="nn">fabio</span>
<span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
    <span class="n">fabio</span> <span class="o">=</span> <span class="kc">None</span>

<span class="kn">from</span> <span class="nn">PyLOSt.ui.stitch_algorithms.simple_average</span> <span class="kn">import</span> <span class="n">SimpleAverage</span>
<span class="kn">from</span> <span class="nn">PyLOSt.util.commons</span> <span class="kn">import</span> <span class="n">alertMsg</span><span class="p">,</span> <span class="n">questionMsg</span>
<span class="kn">from</span> <span class="nn">PyLOSt.databases.gs_table_classes</span> <span class="kn">import</span> <span class="n">connectDB</span>
<span class="n">_file_cache</span> <span class="o">=</span> <span class="p">{}</span>


<div class="viewcode-block" id="Hdf5TreeViewExample"><a class="viewcode-back" href="../../../PyLOSt.ui.html#PyLOSt.ui.hdf5widget_custom.Hdf5TreeViewExample">[docs]</a><span class="k">class</span> <span class="nc">Hdf5TreeViewExample</span><span class="p">(</span><span class="n">qt</span><span class="o">.</span><span class="n">QMainWindow</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This window show an example of use of a Hdf5TreeView.</span>

<span class="sd">    The tree is initialized with a list of filenames. A panel allow to play</span>
<span class="sd">    with internal property configuration of the widget, and a text screen</span>
<span class="sd">    allow to display events.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filenames</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        :param files_: List of HDF5 or Spec files (pathes or</span>
<span class="sd">            :class:`silx.io.spech5.SpecH5` or :class:`h5py.File`</span>
<span class="sd">            instances)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">qt</span><span class="o">.</span><span class="n">QMainWindow</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setWindowTitle</span><span class="p">(</span><span class="s2">&quot;Silx HDF5 widget example&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">__asyncload</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__treeview</span> <span class="o">=</span> <span class="n">silx</span><span class="o">.</span><span class="n">gui</span><span class="o">.</span><span class="n">hdf5</span><span class="o">.</span><span class="n">Hdf5TreeView</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="sd">&quot;&quot;&quot;Silx HDF5 TreeView&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__text</span> <span class="o">=</span> <span class="n">qt</span><span class="o">.</span><span class="n">QTextEdit</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="sd">&quot;&quot;&quot;Widget displaying information&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">colormap</span> <span class="o">=</span> <span class="n">Colormap</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;jet&#39;</span><span class="p">,</span> <span class="n">normalization</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">__dataViewer</span> <span class="o">=</span> <span class="n">DataViewerFrame</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">vSpliter</span> <span class="o">=</span> <span class="n">qt</span><span class="o">.</span><span class="n">QSplitter</span><span class="p">(</span><span class="n">qt</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">Vertical</span><span class="p">)</span>
        <span class="n">vSpliter</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__dataViewer</span><span class="p">)</span>
        <span class="n">vSpliter</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__text</span><span class="p">)</span>
        <span class="n">vSpliter</span><span class="o">.</span><span class="n">setSizes</span><span class="p">([</span><span class="mi">10</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>

        <span class="n">spliter</span> <span class="o">=</span> <span class="n">qt</span><span class="o">.</span><span class="n">QSplitter</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">spliter</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__treeview</span><span class="p">)</span>
        <span class="n">spliter</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">vSpliter</span><span class="p">)</span>
        <span class="n">spliter</span><span class="o">.</span><span class="n">setStretchFactor</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

        <span class="n">main_panel</span> <span class="o">=</span> <span class="n">qt</span><span class="o">.</span><span class="n">QWidget</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">layout</span> <span class="o">=</span> <span class="n">qt</span><span class="o">.</span><span class="n">QVBoxLayout</span><span class="p">()</span>
        <span class="n">layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">spliter</span><span class="p">)</span>
        <span class="n">layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">createTreeViewConfigurationPanel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">__treeview</span><span class="p">))</span>
        <span class="n">layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">additionalComments</span><span class="p">(</span><span class="bp">self</span><span class="p">))</span>
        <span class="n">layout</span><span class="o">.</span><span class="n">setStretchFactor</span><span class="p">(</span><span class="n">spliter</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">main_panel</span><span class="o">.</span><span class="n">setLayout</span><span class="p">(</span><span class="n">layout</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">setCentralWidget</span><span class="p">(</span><span class="n">main_panel</span><span class="p">)</span>

        <span class="c1"># append all files to the tree</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">h5Objs</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="c1">#for file_name in filenames:</span>
        <span class="k">if</span> <span class="n">filenames</span><span class="o">!=</span><span class="kc">None</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">filenames</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
            <span class="n">file_name</span> <span class="o">=</span> <span class="n">filenames</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">h5Objs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">h5py</span><span class="o">.</span><span class="n">File</span><span class="p">(</span><span class="n">file_name</span><span class="p">,</span><span class="s1">&#39;a&#39;</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__treeview</span><span class="o">.</span><span class="n">findHdf5TreeModel</span><span class="p">()</span><span class="o">.</span><span class="n">appendFile</span><span class="p">(</span><span class="n">file_name</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">__treeview</span><span class="o">.</span><span class="n">activated</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">displayData</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__treeview</span><span class="o">.</span><span class="n">activated</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="k">lambda</span> <span class="n">index</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">displayEvent</span><span class="p">(</span><span class="s2">&quot;activated&quot;</span><span class="p">,</span> <span class="n">index</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__treeview</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="k">lambda</span> <span class="n">index</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">displayEvent</span><span class="p">(</span><span class="s2">&quot;clicked&quot;</span><span class="p">,</span> <span class="n">index</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__treeview</span><span class="o">.</span><span class="n">doubleClicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="k">lambda</span> <span class="n">index</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">displayEvent</span><span class="p">(</span><span class="s2">&quot;doubleClicked&quot;</span><span class="p">,</span> <span class="n">index</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__treeview</span><span class="o">.</span><span class="n">entered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="k">lambda</span> <span class="n">index</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">displayEvent</span><span class="p">(</span><span class="s2">&quot;entered&quot;</span><span class="p">,</span> <span class="n">index</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__treeview</span><span class="o">.</span><span class="n">pressed</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="k">lambda</span> <span class="n">index</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">displayEvent</span><span class="p">(</span><span class="s2">&quot;pressed&quot;</span><span class="p">,</span> <span class="n">index</span><span class="p">))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">__treeview</span><span class="o">.</span><span class="n">addContextMenuCallback</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">customContextMenu</span><span class="p">)</span>
        <span class="c1"># lambda function will never be called cause we store it as weakref</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__treeview</span><span class="o">.</span><span class="n">addContextMenuCallback</span><span class="p">(</span><span class="k">lambda</span> <span class="n">event</span><span class="p">:</span> <span class="kc">None</span><span class="p">)</span>
        <span class="c1"># you have to store it first</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__store_lambda</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">event</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">closeAndSyncCustomContextMenu</span><span class="p">(</span><span class="n">event</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__treeview</span><span class="o">.</span><span class="n">addContextMenuCallback</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__store_lambda</span><span class="p">)</span>
    
<div class="viewcode-block" id="Hdf5TreeViewExample.closeEvent"><a class="viewcode-back" href="../../../PyLOSt.ui.html#PyLOSt.ui.hdf5widget_custom.Hdf5TreeViewExample.closeEvent">[docs]</a>    <span class="k">def</span> <span class="nf">closeEvent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">finish</span><span class="p">()</span>
        <span class="n">event</span><span class="o">.</span><span class="n">accept</span><span class="p">()</span></div>
        
<div class="viewcode-block" id="Hdf5TreeViewExample.finish"><a class="viewcode-back" href="../../../PyLOSt.ui.html#PyLOSt.ui.hdf5widget_custom.Hdf5TreeViewExample.finish">[docs]</a>    <span class="k">def</span> <span class="nf">finish</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">it</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">h5Objs</span><span class="p">:</span>
            <span class="n">it</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></div>

<div class="viewcode-block" id="Hdf5TreeViewExample.editMeta"><a class="viewcode-back" href="../../../PyLOSt.ui.html#PyLOSt.ui.hdf5widget_custom.Hdf5TreeViewExample.editMeta">[docs]</a>    <span class="k">def</span> <span class="nf">editMeta</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">selNodeList</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__treeview</span><span class="o">.</span><span class="n">selectedH5Nodes</span><span class="p">())</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">len</span><span class="p">(</span><span class="n">selNodeList</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">alertMsg</span><span class="p">(</span><span class="s1">&#39;Error&#39;</span><span class="p">,</span> <span class="s1">&#39;Please select a measurement entry&#39;</span><span class="p">)</span>
                <span class="k">return</span>
            <span class="n">h5entry</span> <span class="o">=</span> <span class="n">selNodeList</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">setupDialog</span> <span class="o">=</span> <span class="n">SGEditMetaData</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">msrEntry</span><span class="o">=</span><span class="n">h5entry</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">setupDialog</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;editMeta &lt;- Hdf5TreeViewExample&#39;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
            <span class="n">alertMsg</span><span class="p">(</span><span class="s1">&#39;Error&#39;</span><span class="p">,</span> <span class="s1">&#39;Editing meta data failed&#39;</span><span class="p">)</span></div>

<div class="viewcode-block" id="Hdf5TreeViewExample.addNewSetup"><a class="viewcode-back" href="../../../PyLOSt.ui.html#PyLOSt.ui.hdf5widget_custom.Hdf5TreeViewExample.addNewSetup">[docs]</a>    <span class="k">def</span> <span class="nf">addNewSetup</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">selNodeList</span>        <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__treeview</span><span class="o">.</span><span class="n">selectedH5Nodes</span><span class="p">())</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">len</span><span class="p">(</span><span class="n">selNodeList</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
                <span class="n">alertMsg</span><span class="p">(</span><span class="s1">&#39;Error&#39;</span><span class="p">,</span> <span class="s1">&#39;Please select a measurement entry&#39;</span><span class="p">)</span>
                <span class="k">return</span>
            <span class="n">h5entry</span>            <span class="o">=</span> <span class="n">selNodeList</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">insTxtId</span>           <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">h5Objs</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">h5entry</span><span class="o">.</span><span class="n">name</span><span class="p">][</span><span class="s1">&#39;Instrument&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="sa">u</span><span class="s1">&#39;instr_id&#39;</span><span class="p">]</span>
            
            <span class="bp">self</span><span class="o">.</span><span class="n">setupDialog</span> <span class="o">=</span> <span class="n">SGNewStitchSetup</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">insTxtId</span><span class="o">=</span><span class="n">insTxtId</span><span class="p">,</span> <span class="n">msrEntry</span><span class="o">=</span><span class="n">h5entry</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">setupDialog</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;addNewSetup &lt;- Hdf5TreeViewExample&#39;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
            <span class="n">alertMsg</span><span class="p">(</span><span class="s1">&#39;Error&#39;</span><span class="p">,</span> <span class="s1">&#39;Add stitching setup failed. Please select a valid measurement entry&#39;</span><span class="p">)</span></div>
            
<div class="viewcode-block" id="Hdf5TreeViewExample.displayData"><a class="viewcode-back" href="../../../PyLOSt.ui.html#PyLOSt.ui.hdf5widget_custom.Hdf5TreeViewExample.displayData">[docs]</a>    <span class="k">def</span> <span class="nf">displayData</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Called to update the dataviewer with the selected data.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">selected</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__treeview</span><span class="o">.</span><span class="n">selectedH5Nodes</span><span class="p">())</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">selected</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="c1"># Update the viewer for a single selection</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">selected</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="c1"># data is a hdf5.H5Node object</span>
            <span class="c1"># data.h5py_object is a Group/Dataset object (from h5py, spech5, fabioh5)</span>
            <span class="c1"># The dataviewer can display both</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__dataViewer</span><span class="o">.</span><span class="n">setData</span><span class="p">(</span><span class="n">data</span><span class="p">)</span></div>

<div class="viewcode-block" id="Hdf5TreeViewExample.displayEvent"><a class="viewcode-back" href="../../../PyLOSt.ui.html#PyLOSt.ui.hdf5widget_custom.Hdf5TreeViewExample.displayEvent">[docs]</a>    <span class="k">def</span> <span class="nf">displayEvent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">eventName</span><span class="p">,</span> <span class="n">index</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Called to log event in widget</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">def</span> <span class="nf">formatKey</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
            <span class="n">name</span><span class="p">,</span> <span class="n">value</span> <span class="o">=</span> <span class="n">silx</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">html</span><span class="o">.</span><span class="n">escape</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">name</span><span class="p">)),</span> <span class="n">silx</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">html</span><span class="o">.</span><span class="n">escape</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">value</span><span class="p">))</span>
            <span class="k">return</span> <span class="s2">&quot;&lt;li&gt;&lt;b&gt;</span><span class="si">%s</span><span class="s2">&lt;/b&gt;: </span><span class="si">%s</span><span class="s2">&lt;/li&gt;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>

        <span class="n">text</span> <span class="o">=</span> <span class="s2">&quot;&lt;html&gt;&quot;</span>
        <span class="n">text</span> <span class="o">+=</span> <span class="s2">&quot;&lt;h1&gt;Event&lt;/h1&gt;&quot;</span>
        <span class="n">text</span> <span class="o">+=</span> <span class="s2">&quot;&lt;ul&gt;&quot;</span>
        <span class="n">text</span> <span class="o">+=</span> <span class="n">formatKey</span><span class="p">(</span><span class="s2">&quot;name&quot;</span><span class="p">,</span> <span class="n">eventName</span><span class="p">)</span>
        <span class="n">text</span> <span class="o">+=</span> <span class="n">formatKey</span><span class="p">(</span><span class="s2">&quot;index&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">index</span><span class="p">))</span>
        <span class="n">text</span> <span class="o">+=</span> <span class="s2">&quot;&lt;/ul&gt;&quot;</span>

        <span class="n">text</span> <span class="o">+=</span> <span class="s2">&quot;&lt;h1&gt;Selected HDF5 objects&lt;/h1&gt;&quot;</span>

        <span class="k">for</span> <span class="n">h5_obj</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__treeview</span><span class="o">.</span><span class="n">selectedH5Nodes</span><span class="p">():</span>
            <span class="n">text</span> <span class="o">+=</span> <span class="s2">&quot;&lt;h2&gt;HDF5 object&lt;/h2&gt;&quot;</span>
            <span class="n">text</span> <span class="o">+=</span> <span class="s2">&quot;&lt;ul&gt;&quot;</span>
            <span class="n">text</span> <span class="o">+=</span> <span class="n">formatKey</span><span class="p">(</span><span class="s2">&quot;local_filename&quot;</span><span class="p">,</span> <span class="n">h5_obj</span><span class="o">.</span><span class="n">local_file</span><span class="o">.</span><span class="n">filename</span><span class="p">)</span>
            <span class="n">text</span> <span class="o">+=</span> <span class="n">formatKey</span><span class="p">(</span><span class="s2">&quot;local_basename&quot;</span><span class="p">,</span> <span class="n">h5_obj</span><span class="o">.</span><span class="n">local_basename</span><span class="p">)</span>
            <span class="n">text</span> <span class="o">+=</span> <span class="n">formatKey</span><span class="p">(</span><span class="s2">&quot;local_name&quot;</span><span class="p">,</span> <span class="n">h5_obj</span><span class="o">.</span><span class="n">local_name</span><span class="p">)</span>
            <span class="n">text</span> <span class="o">+=</span> <span class="n">formatKey</span><span class="p">(</span><span class="s2">&quot;real_filename&quot;</span><span class="p">,</span> <span class="n">h5_obj</span><span class="o">.</span><span class="n">file</span><span class="o">.</span><span class="n">filename</span><span class="p">)</span>
            <span class="n">text</span> <span class="o">+=</span> <span class="n">formatKey</span><span class="p">(</span><span class="s2">&quot;real_basename&quot;</span><span class="p">,</span> <span class="n">h5_obj</span><span class="o">.</span><span class="n">basename</span><span class="p">)</span>
            <span class="n">text</span> <span class="o">+=</span> <span class="n">formatKey</span><span class="p">(</span><span class="s2">&quot;real_name&quot;</span><span class="p">,</span> <span class="n">h5_obj</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>

            <span class="n">text</span> <span class="o">+=</span> <span class="n">formatKey</span><span class="p">(</span><span class="s2">&quot;obj&quot;</span><span class="p">,</span> <span class="n">h5_obj</span><span class="o">.</span><span class="n">ntype</span><span class="p">)</span>
            <span class="n">text</span> <span class="o">+=</span> <span class="n">formatKey</span><span class="p">(</span><span class="s2">&quot;dtype&quot;</span><span class="p">,</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">h5_obj</span><span class="p">,</span> <span class="s2">&quot;dtype&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">))</span>
            <span class="n">text</span> <span class="o">+=</span> <span class="n">formatKey</span><span class="p">(</span><span class="s2">&quot;shape&quot;</span><span class="p">,</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">h5_obj</span><span class="p">,</span> <span class="s2">&quot;shape&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">))</span>
            <span class="n">text</span> <span class="o">+=</span> <span class="n">formatKey</span><span class="p">(</span><span class="s2">&quot;attrs&quot;</span><span class="p">,</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">h5_obj</span><span class="p">,</span> <span class="s2">&quot;attrs&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">))</span>
            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">h5_obj</span><span class="p">,</span> <span class="s2">&quot;attrs&quot;</span><span class="p">):</span>
                <span class="n">text</span> <span class="o">+=</span> <span class="s2">&quot;&lt;ul&gt;&quot;</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">h5_obj</span><span class="o">.</span><span class="n">attrs</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">text</span> <span class="o">+=</span> <span class="s2">&quot;&lt;li&gt;empty&lt;/li&gt;&quot;</span>
                <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">h5_obj</span><span class="o">.</span><span class="n">attrs</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                    <span class="n">text</span> <span class="o">+=</span> <span class="n">formatKey</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
                <span class="n">text</span> <span class="o">+=</span> <span class="s2">&quot;&lt;/ul&gt;&quot;</span>
            <span class="n">text</span> <span class="o">+=</span> <span class="s2">&quot;&lt;/ul&gt;&quot;</span>

        <span class="n">text</span> <span class="o">+=</span> <span class="s2">&quot;&lt;/html&gt;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__text</span><span class="o">.</span><span class="n">setHtml</span><span class="p">(</span><span class="n">text</span><span class="p">)</span></div>

<div class="viewcode-block" id="Hdf5TreeViewExample.useAsyncLoad"><a class="viewcode-back" href="../../../PyLOSt.ui.html#PyLOSt.ui.hdf5widget_custom.Hdf5TreeViewExample.useAsyncLoad">[docs]</a>    <span class="k">def</span> <span class="nf">useAsyncLoad</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">useAsync</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__asyncload</span> <span class="o">=</span> <span class="n">useAsync</span></div>

    <span class="k">def</span> <span class="nf">__fileCreated</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__asyncload</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__treeview</span><span class="o">.</span><span class="n">findHdf5TreeModel</span><span class="p">()</span><span class="o">.</span><span class="n">insertFileAsync</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__treeview</span><span class="o">.</span><span class="n">findHdf5TreeModel</span><span class="p">()</span><span class="o">.</span><span class="n">insertFile</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>

<div class="viewcode-block" id="Hdf5TreeViewExample.customContextMenu"><a class="viewcode-back" href="../../../PyLOSt.ui.html#PyLOSt.ui.hdf5widget_custom.Hdf5TreeViewExample.customContextMenu">[docs]</a>    <span class="k">def</span> <span class="nf">customContextMenu</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Called to populate the context menu</span>

<span class="sd">        :param silx.gui.hdf5.Hdf5ContextMenuEvent event: Event</span>
<span class="sd">            containing expected information to populate the context menu</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">selectedObjects</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">source</span><span class="p">()</span><span class="o">.</span><span class="n">selectedH5Nodes</span><span class="p">()</span>
        <span class="n">menu</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">menu</span><span class="p">()</span>

        <span class="n">hasDataset</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">hasGroup</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">selectedObjects</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">obj</span><span class="o">.</span><span class="n">ntype</span> <span class="ow">is</span> <span class="n">h5py</span><span class="o">.</span><span class="n">Dataset</span><span class="p">:</span>
                <span class="n">hasDataset</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="k">break</span>
            <span class="k">if</span> <span class="n">obj</span><span class="o">.</span><span class="n">ntype</span> <span class="ow">is</span> <span class="n">h5py</span><span class="o">.</span><span class="n">Group</span><span class="p">:</span>
                <span class="n">hasGroup</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="k">break</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">menu</span><span class="o">.</span><span class="n">isEmpty</span><span class="p">():</span>
            <span class="n">menu</span><span class="o">.</span><span class="n">addSeparator</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">hasDataset</span> <span class="ow">or</span> <span class="n">hasGroup</span><span class="p">:</span>
            <span class="n">action</span> <span class="o">=</span> <span class="n">qt</span><span class="o">.</span><span class="n">QAction</span><span class="p">(</span><span class="s2">&quot;Remove the item&quot;</span><span class="p">,</span> <span class="n">event</span><span class="o">.</span><span class="n">source</span><span class="p">())</span>
            <span class="n">action</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">removeObj</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">h5py_object</span><span class="p">,</span> <span class="n">model</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">__treeview</span><span class="o">.</span><span class="n">findHdf5TreeModel</span><span class="p">()))</span><span class="c1">#self.__treeview.findHdf5TreeModel().removeH5pyObject(obj.h5py_object))</span>
            <span class="n">menu</span><span class="o">.</span><span class="n">addAction</span><span class="p">(</span><span class="n">action</span><span class="p">)</span>
            <span class="k">if</span> <span class="s1">&#39;NX_class&#39;</span> <span class="ow">in</span> <span class="n">obj</span><span class="o">.</span><span class="n">attrs</span> <span class="ow">and</span> <span class="n">obj</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;NX_class&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;NXentry&#39;</span> <span class="ow">and</span> <span class="n">obj</span><span class="o">.</span><span class="n">name</span><span class="o">!=</span><span class="s1">&#39;/StitchResults&#39;</span><span class="p">:</span>
                <span class="n">action</span> <span class="o">=</span> <span class="n">qt</span><span class="o">.</span><span class="n">QAction</span><span class="p">(</span><span class="s2">&quot;Add stitch setup&quot;</span><span class="p">,</span> <span class="n">event</span><span class="o">.</span><span class="n">source</span><span class="p">())</span>
                <span class="n">action</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">addNewSetup</span><span class="p">)</span>
                <span class="n">menu</span><span class="o">.</span><span class="n">addAction</span><span class="p">(</span><span class="n">action</span><span class="p">)</span>
                <span class="c1"># action = qt.QAction(&quot;Import reference&quot;, event.source())</span>
                <span class="c1"># action.triggered.connect(self.importReference)</span>
                <span class="c1"># menu.addAction(action)</span>
                <span class="n">action</span> <span class="o">=</span> <span class="n">qt</span><span class="o">.</span><span class="n">QAction</span><span class="p">(</span><span class="s2">&quot;Edit meta data&quot;</span><span class="p">,</span> <span class="n">event</span><span class="o">.</span><span class="n">source</span><span class="p">())</span>
                <span class="n">action</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">editMeta</span><span class="p">)</span>
                <span class="n">menu</span><span class="o">.</span><span class="n">addAction</span><span class="p">(</span><span class="n">action</span><span class="p">)</span>
            <span class="k">if</span> <span class="s1">&#39;NX_class&#39;</span> <span class="ow">in</span> <span class="n">obj</span><span class="o">.</span><span class="n">attrs</span> <span class="ow">and</span> <span class="n">obj</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;NX_class&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;NXprocess&#39;</span><span class="p">:</span>
                <span class="n">action</span> <span class="o">=</span> <span class="n">qt</span><span class="o">.</span><span class="n">QAction</span><span class="p">(</span><span class="s2">&quot;Run stitching&quot;</span><span class="p">,</span> <span class="n">event</span><span class="o">.</span><span class="n">source</span><span class="p">())</span>
                <span class="n">action</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stitchData</span><span class="p">)</span>
                <span class="n">menu</span><span class="o">.</span><span class="n">addAction</span><span class="p">(</span><span class="n">action</span><span class="p">)</span>
                <span class="k">if</span> <span class="s1">&#39;stitched_scans&#39;</span> <span class="ow">in</span> <span class="n">obj</span><span class="o">.</span><span class="n">h5py_object</span><span class="p">:</span>
                    <span class="n">action</span> <span class="o">=</span> <span class="n">qt</span><span class="o">.</span><span class="n">QAction</span><span class="p">(</span><span class="s2">&quot;Average stitched scans&quot;</span><span class="p">,</span> <span class="n">event</span><span class="o">.</span><span class="n">source</span><span class="p">())</span>
                    <span class="n">action</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">avgStitchedScans</span><span class="p">)</span>
                    <span class="n">menu</span><span class="o">.</span><span class="n">addAction</span><span class="p">(</span><span class="n">action</span><span class="p">)</span>
                    <span class="n">action</span> <span class="o">=</span> <span class="n">qt</span><span class="o">.</span><span class="n">QAction</span><span class="p">(</span><span class="s2">&quot;Standard dev stitched scans&quot;</span><span class="p">,</span> <span class="n">event</span><span class="o">.</span><span class="n">source</span><span class="p">())</span>
                    <span class="n">action</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">getStdScans</span><span class="p">)</span>
                    <span class="n">menu</span><span class="o">.</span><span class="n">addAction</span><span class="p">(</span><span class="n">action</span><span class="p">)</span>
                    <span class="k">if</span> <span class="s1">&#39;data_type&#39;</span> <span class="ow">in</span> <span class="n">obj</span><span class="o">.</span><span class="n">attrs</span> <span class="ow">and</span> <span class="n">obj</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;data_type&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;slope&#39;</span><span class="p">:</span>
                        <span class="n">action</span> <span class="o">=</span> <span class="n">qt</span><span class="o">.</span><span class="n">QAction</span><span class="p">(</span><span class="s2">&quot;Integrate 2D slopes&quot;</span><span class="p">,</span> <span class="n">event</span><span class="o">.</span><span class="n">source</span><span class="p">())</span>
                        <span class="n">action</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">intSlp2Hgt</span><span class="p">)</span>
                        <span class="n">menu</span><span class="o">.</span><span class="n">addAction</span><span class="p">(</span><span class="n">action</span><span class="p">)</span>

            <span class="c1"># if &#39;NX_class&#39; in obj.attrs and obj.attrs[&#39;NX_class&#39;]==&#39;NXentry&#39;:</span>
            <span class="c1">#     action = qt.QAction(&quot;Change reference&quot;, event.source())</span>
            <span class="c1">#     action.triggered.connect(lambda: self.changeRef(obj.h5py_object, model=self.__treeview.findHdf5TreeModel()))</span>
            <span class="c1">#     menu.addAction(action)</span>
            <span class="k">if</span> <span class="s1">&#39;NX_class&#39;</span> <span class="ow">in</span> <span class="n">obj</span><span class="o">.</span><span class="n">attrs</span> <span class="ow">and</span> <span class="n">obj</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;NX_class&#39;</span><span class="p">]</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;NXentry&#39;</span><span class="p">,</span><span class="s1">&#39;NXprocess&#39;</span><span class="p">,</span><span class="s1">&#39;NXdata&#39;</span><span class="p">]:</span>
                <span class="n">action</span> <span class="o">=</span> <span class="n">qt</span><span class="o">.</span><span class="n">QAction</span><span class="p">(</span><span class="s2">&quot;Export to file&quot;</span><span class="p">,</span> <span class="n">event</span><span class="o">.</span><span class="n">source</span><span class="p">())</span>
                <span class="n">action</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">exportToFile</span><span class="p">)</span>
                <span class="n">menu</span><span class="o">.</span><span class="n">addAction</span><span class="p">(</span><span class="n">action</span><span class="p">)</span></div>


<div class="viewcode-block" id="Hdf5TreeViewExample.exportToFile"><a class="viewcode-back" href="../../../PyLOSt.ui.html#PyLOSt.ui.hdf5widget_custom.Hdf5TreeViewExample.exportToFile">[docs]</a>    <span class="k">def</span> <span class="nf">exportToFile</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">selected</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__treeview</span><span class="o">.</span><span class="n">selectedH5Nodes</span><span class="p">())</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">selected</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">loc_newH5File</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">QFileDialog</span><span class="o">.</span><span class="n">getSaveFileName</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;Export to file&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">loc_newH5File</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;.h5&#39;</span><span class="p">):</span>
                <span class="n">loc_newH5File</span> <span class="o">=</span> <span class="n">loc_newH5File</span> <span class="o">+</span> <span class="s1">&#39;.h5&#39;</span>
            <span class="n">h5new</span> <span class="o">=</span> <span class="n">h5py</span><span class="o">.</span><span class="n">File</span><span class="p">(</span><span class="n">loc_newH5File</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">it</span> <span class="ow">in</span> <span class="n">selected</span><span class="p">:</span>
                <span class="n">parent_path</span> <span class="o">=</span> <span class="n">it</span><span class="o">.</span><span class="n">h5py_object</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">name</span>
                <span class="n">h5new_grp_id</span> <span class="o">=</span> <span class="n">h5new</span><span class="o">.</span><span class="n">require_group</span><span class="p">(</span><span class="n">parent_path</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">h5Objs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">it</span><span class="o">.</span><span class="n">h5py_object</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">h5new_grp_id</span><span class="p">)</span>
            <span class="n">h5new</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></div>

    <span class="c1">#TODO: implement synchronizig loaded h5 object</span>
<div class="viewcode-block" id="Hdf5TreeViewExample.syncH5Obj"><a class="viewcode-back" href="../../../PyLOSt.ui.html#PyLOSt.ui.hdf5widget_custom.Hdf5TreeViewExample.syncH5Obj">[docs]</a>    <span class="k">def</span> <span class="nf">syncH5Obj</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">h5Obj</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">model</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__treeview</span><span class="o">.</span><span class="n">findHdf5TreeModel</span><span class="p">()</span>
            <span class="n">model</span><span class="o">.</span><span class="n">synchronizeIndex</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">qt</span><span class="o">.</span><span class="n">QModelIndex</span><span class="p">()))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__treeview</span><span class="o">.</span><span class="n">setSelectedH5Node</span><span class="p">(</span><span class="n">h5Obj</span><span class="p">)</span> <span class="c1"># TODO: not expanding to node</span>
            <span class="c1"># self.__treeview.findHdf5TreeModel().synchronizeH5pyObject(h5Obj)</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;syncH5Obj &lt;- Hdf5TreeViewExample&#39;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="p">)</span></div>

<div class="viewcode-block" id="Hdf5TreeViewExample.removeObj"><a class="viewcode-back" href="../../../PyLOSt.ui.html#PyLOSt.ui.hdf5widget_custom.Hdf5TreeViewExample.removeObj">[docs]</a>    <span class="k">def</span> <span class="nf">removeObj</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">h5Obj</span><span class="p">,</span> <span class="n">model</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Remove an object from h5 file</span>

<span class="sd">        :param h5Obj: Object to remove</span>
<span class="sd">        :param model:</span>
<span class="sd">        :return:</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">questionMsg</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">&quot;Remove Object&quot;</span><span class="p">,</span><span class="n">msg</span><span class="o">=</span><span class="s2">&quot;This will permanently removes the selected object from h5 file. Are you sure (yes/no)&quot;</span><span class="p">):</span>
                <span class="n">prnt</span> <span class="o">=</span> <span class="n">h5Obj</span><span class="o">.</span><span class="n">parent</span>
                <span class="n">nm</span> <span class="o">=</span> <span class="n">h5Obj</span><span class="o">.</span><span class="n">name</span>
                <span class="c1"># del h5Obj.file[nm]</span>
                <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">h5Objs</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">nm</span><span class="p">]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">syncH5Obj</span><span class="p">(</span><span class="n">prnt</span><span class="p">)</span> <span class="c1">## not working...</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;removeObj &lt;- Hdf5TreeViewExample&#39;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="p">)</span></div>

<div class="viewcode-block" id="Hdf5TreeViewExample.closeAndSyncCustomContextMenu"><a class="viewcode-back" href="../../../PyLOSt.ui.html#PyLOSt.ui.hdf5widget_custom.Hdf5TreeViewExample.closeAndSyncCustomContextMenu">[docs]</a>    <span class="k">def</span> <span class="nf">closeAndSyncCustomContextMenu</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Called to populate the context menu</span>

<span class="sd">        :param silx.gui.hdf5.Hdf5ContextMenuEvent event: Event</span>
<span class="sd">            containing expected information to populate the context menu</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">selectedObjects</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">source</span><span class="p">()</span><span class="o">.</span><span class="n">selectedH5Nodes</span><span class="p">()</span>
        <span class="n">menu</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">menu</span><span class="p">()</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">menu</span><span class="o">.</span><span class="n">isEmpty</span><span class="p">():</span>
            <span class="n">menu</span><span class="o">.</span><span class="n">addSeparator</span><span class="p">()</span>

        <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">selectedObjects</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">obj</span><span class="o">.</span><span class="n">ntype</span> <span class="ow">is</span> <span class="n">h5py</span><span class="o">.</span><span class="n">File</span><span class="p">:</span>
                <span class="n">action</span> <span class="o">=</span> <span class="n">qt</span><span class="o">.</span><span class="n">QAction</span><span class="p">(</span><span class="s2">&quot;Remove </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">obj</span><span class="o">.</span><span class="n">local_filename</span><span class="p">,</span> <span class="n">event</span><span class="o">.</span><span class="n">source</span><span class="p">())</span>
                <span class="n">action</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">__treeview</span><span class="o">.</span><span class="n">findHdf5TreeModel</span><span class="p">()</span><span class="o">.</span><span class="n">removeH5pyObject</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">h5py_object</span><span class="p">))</span>
                <span class="n">menu</span><span class="o">.</span><span class="n">addAction</span><span class="p">(</span><span class="n">action</span><span class="p">)</span>
                <span class="n">action</span> <span class="o">=</span> <span class="n">qt</span><span class="o">.</span><span class="n">QAction</span><span class="p">(</span><span class="s2">&quot;Synchronize </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">obj</span><span class="o">.</span><span class="n">local_filename</span><span class="p">,</span> <span class="n">event</span><span class="o">.</span><span class="n">source</span><span class="p">())</span>
                <span class="n">action</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">__treeview</span><span class="o">.</span><span class="n">findHdf5TreeModel</span><span class="p">()</span><span class="o">.</span><span class="n">synchronizeH5pyObject</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">h5py_object</span><span class="p">))</span>
                <span class="n">menu</span><span class="o">.</span><span class="n">addAction</span><span class="p">(</span><span class="n">action</span><span class="p">)</span></div>

<div class="viewcode-block" id="Hdf5TreeViewExample.additionalComments"><a class="viewcode-back" href="../../../PyLOSt.ui.html#PyLOSt.ui.hdf5widget_custom.Hdf5TreeViewExample.additionalComments">[docs]</a>    <span class="k">def</span> <span class="nf">additionalComments</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">parent</span><span class="p">):</span>
        <span class="n">panel</span> <span class="o">=</span> <span class="n">qt</span><span class="o">.</span><span class="n">QWidget</span><span class="p">(</span><span class="n">parent</span><span class="p">)</span>
        <span class="n">panel</span><span class="o">.</span><span class="n">setLayout</span><span class="p">(</span><span class="n">qt</span><span class="o">.</span><span class="n">QVBoxLayout</span><span class="p">())</span>

        <span class="n">option</span> <span class="o">=</span> <span class="n">qt</span><span class="o">.</span><span class="n">QLabel</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">panel</span><span class="p">)</span>
        <span class="n">option</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s2">&quot;Info: Data entries have /Instrument, /Measurement, /Sample groups, which contains mostly static data. These will be updated with measurement meta info in the future release&quot;</span><span class="p">)</span>
        <span class="n">option</span><span class="o">.</span><span class="n">setStyleSheet</span><span class="p">(</span><span class="s1">&#39;color: green&#39;</span><span class="p">)</span>
        <span class="n">panel</span><span class="o">.</span><span class="n">layout</span><span class="p">()</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">option</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">panel</span></div>


<div class="viewcode-block" id="Hdf5TreeViewExample.createTreeViewConfigurationPanel"><a class="viewcode-back" href="../../../PyLOSt.ui.html#PyLOSt.ui.hdf5widget_custom.Hdf5TreeViewExample.createTreeViewConfigurationPanel">[docs]</a>    <span class="k">def</span> <span class="nf">createTreeViewConfigurationPanel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="p">,</span> <span class="n">treeview</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Create a configuration panel to allow to play with widget states&quot;&quot;&quot;</span>
        <span class="n">panel</span> <span class="o">=</span> <span class="n">qt</span><span class="o">.</span><span class="n">QWidget</span><span class="p">(</span><span class="n">parent</span><span class="p">)</span>
        <span class="n">panel</span><span class="o">.</span><span class="n">setLayout</span><span class="p">(</span><span class="n">qt</span><span class="o">.</span><span class="n">QHBoxLayout</span><span class="p">())</span>


        <span class="n">option</span> <span class="o">=</span> <span class="n">qt</span><span class="o">.</span><span class="n">QGroupBox</span><span class="p">(</span><span class="s2">&quot;Tree options&quot;</span><span class="p">,</span> <span class="n">panel</span><span class="p">)</span>
        <span class="n">option</span><span class="o">.</span><span class="n">setLayout</span><span class="p">(</span><span class="n">qt</span><span class="o">.</span><span class="n">QVBoxLayout</span><span class="p">())</span>
        <span class="n">panel</span><span class="o">.</span><span class="n">layout</span><span class="p">()</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">option</span><span class="p">)</span>

        <span class="n">sorting</span> <span class="o">=</span> <span class="n">qt</span><span class="o">.</span><span class="n">QCheckBox</span><span class="p">(</span><span class="s2">&quot;Enable sorting&quot;</span><span class="p">,</span> <span class="n">option</span><span class="p">)</span>
        <span class="n">sorting</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="n">treeview</span><span class="o">.</span><span class="n">selectionMode</span><span class="p">()</span> <span class="o">==</span> <span class="n">qt</span><span class="o">.</span><span class="n">QAbstractItemView</span><span class="o">.</span><span class="n">MultiSelection</span><span class="p">)</span>
        <span class="n">sorting</span><span class="o">.</span><span class="n">toggled</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="n">treeview</span><span class="o">.</span><span class="n">setSortingEnabled</span><span class="p">(</span><span class="n">sorting</span><span class="o">.</span><span class="n">isChecked</span><span class="p">()))</span>
        <span class="n">option</span><span class="o">.</span><span class="n">layout</span><span class="p">()</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">sorting</span><span class="p">)</span>

        <span class="n">multiselection</span> <span class="o">=</span> <span class="n">qt</span><span class="o">.</span><span class="n">QCheckBox</span><span class="p">(</span><span class="s2">&quot;Multi-selection&quot;</span><span class="p">,</span> <span class="n">option</span><span class="p">)</span>
        <span class="n">multiselection</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="n">treeview</span><span class="o">.</span><span class="n">selectionMode</span><span class="p">()</span> <span class="o">==</span> <span class="n">qt</span><span class="o">.</span><span class="n">QAbstractItemView</span><span class="o">.</span><span class="n">MultiSelection</span><span class="p">)</span>
        <span class="n">switch_selection</span> <span class="o">=</span> <span class="k">lambda</span><span class="p">:</span> <span class="n">treeview</span><span class="o">.</span><span class="n">setSelectionMode</span><span class="p">(</span>
            <span class="n">qt</span><span class="o">.</span><span class="n">QAbstractItemView</span><span class="o">.</span><span class="n">MultiSelection</span> <span class="k">if</span> <span class="n">multiselection</span><span class="o">.</span><span class="n">isChecked</span><span class="p">()</span>
            <span class="k">else</span> <span class="n">qt</span><span class="o">.</span><span class="n">QAbstractItemView</span><span class="o">.</span><span class="n">SingleSelection</span><span class="p">)</span>
        <span class="n">multiselection</span><span class="o">.</span><span class="n">toggled</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">switch_selection</span><span class="p">)</span>
        <span class="n">option</span><span class="o">.</span><span class="n">layout</span><span class="p">()</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">multiselection</span><span class="p">)</span>

        <span class="c1"># filedrop = qt.QCheckBox(&quot;Drop external file&quot;, option)</span>
        <span class="c1"># filedrop.setChecked(treeview.findHdf5TreeModel().isFileDropEnabled())</span>
        <span class="c1"># filedrop.toggled.connect(lambda: treeview.findHdf5TreeModel().setFileDropEnabled(filedrop.isChecked()))</span>
        <span class="c1"># option.layout().addWidget(filedrop)</span>
        <span class="c1">#</span>
        <span class="c1"># filemove = qt.QCheckBox(&quot;Reorder files&quot;, option)</span>
        <span class="c1"># filemove.setChecked(treeview.findHdf5TreeModel().isFileMoveEnabled())</span>
        <span class="c1"># filemove.toggled.connect(lambda: treeview.findHdf5TreeModel().setFileMoveEnabled(filedrop.isChecked()))</span>
        <span class="c1"># option.layout().addWidget(filemove)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">owStitch</span> <span class="o">=</span> <span class="n">qt</span><span class="o">.</span><span class="n">QCheckBox</span><span class="p">(</span><span class="s2">&quot;Overwrite stitching data&quot;</span><span class="p">,</span> <span class="n">option</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">owStitch</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">option</span><span class="o">.</span><span class="n">layout</span><span class="p">()</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">owStitch</span><span class="p">)</span>

        <span class="c1"># option.layout().addStretch(1)</span>

        <span class="c1"># option = qt.QGroupBox(&quot;Header options&quot;, panel)</span>
        <span class="c1"># option.setLayout(qt.QVBoxLayout())</span>
        <span class="c1"># panel.layout().addWidget(option)</span>

        <span class="c1"># autosize = qt.QCheckBox(&quot;Auto-size headers&quot;, option)</span>
        <span class="c1"># autosize.setChecked(treeview.header().hasAutoResizeColumns())</span>
        <span class="c1"># autosize.toggled.connect(lambda: treeview.header().setAutoResizeColumns(autosize.isChecked()))</span>
        <span class="c1"># option.layout().addWidget(autosize)</span>
        <span class="c1">#</span>
        <span class="c1"># columnpopup = qt.QCheckBox(&quot;Popup to hide/show columns&quot;, option)</span>
        <span class="c1"># columnpopup.setChecked(treeview.header().hasHideColumnsPopup())</span>
        <span class="c1"># columnpopup.toggled.connect(lambda: treeview.header().setEnableHideColumnsPopup(columnpopup.isChecked()))</span>
        <span class="c1"># option.layout().addWidget(columnpopup)</span>

        <span class="n">define_columns</span> <span class="o">=</span> <span class="n">qt</span><span class="o">.</span><span class="n">QComboBox</span><span class="p">()</span>
        <span class="n">define_columns</span><span class="o">.</span><span class="n">addItem</span><span class="p">(</span><span class="s2">&quot;Default columns&quot;</span><span class="p">,</span> <span class="n">treeview</span><span class="o">.</span><span class="n">findHdf5TreeModel</span><span class="p">()</span><span class="o">.</span><span class="n">COLUMN_IDS</span><span class="p">)</span>
        <span class="n">define_columns</span><span class="o">.</span><span class="n">addItem</span><span class="p">(</span><span class="s2">&quot;Only name and Value&quot;</span><span class="p">,</span> <span class="p">[</span><span class="n">treeview</span><span class="o">.</span><span class="n">findHdf5TreeModel</span><span class="p">()</span><span class="o">.</span><span class="n">NAME_COLUMN</span><span class="p">,</span> <span class="n">treeview</span><span class="o">.</span><span class="n">findHdf5TreeModel</span><span class="p">()</span><span class="o">.</span><span class="n">VALUE_COLUMN</span><span class="p">])</span>
        <span class="n">define_columns</span><span class="o">.</span><span class="n">activated</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="k">lambda</span> <span class="n">index</span><span class="p">:</span> <span class="n">treeview</span><span class="o">.</span><span class="n">header</span><span class="p">()</span><span class="o">.</span><span class="n">setSections</span><span class="p">(</span><span class="n">define_columns</span><span class="o">.</span><span class="n">itemData</span><span class="p">(</span><span class="n">index</span><span class="p">)))</span>
        <span class="n">option</span><span class="o">.</span><span class="n">layout</span><span class="p">()</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">define_columns</span><span class="p">)</span>

        <span class="n">option</span><span class="o">.</span><span class="n">layout</span><span class="p">()</span><span class="o">.</span><span class="n">addStretch</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        
        <span class="c1">#Stitching options</span>
        <span class="n">option</span> <span class="o">=</span> <span class="n">qt</span><span class="o">.</span><span class="n">QGroupBox</span><span class="p">(</span><span class="s2">&quot;Stitching options&quot;</span><span class="p">,</span> <span class="n">panel</span><span class="p">)</span>
        <span class="n">option</span><span class="o">.</span><span class="n">setLayout</span><span class="p">(</span><span class="n">qt</span><span class="o">.</span><span class="n">QVBoxLayout</span><span class="p">())</span>
        <span class="n">panel</span><span class="o">.</span><span class="n">layout</span><span class="p">()</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">option</span><span class="p">)</span>
         
        <span class="n">btnNewSetup</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="s1">&#39;Add New Stitch Setup&#39;</span><span class="p">,</span> <span class="n">option</span><span class="p">)</span>
        <span class="n">btnNewSetup</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">addNewSetup</span><span class="p">)</span>
        <span class="n">option</span><span class="o">.</span><span class="n">layout</span><span class="p">()</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">btnNewSetup</span><span class="p">)</span>
        
        <span class="n">btnStitch</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="s1">&#39;Stitch&#39;</span><span class="p">,</span> <span class="n">option</span><span class="p">)</span>
        <span class="n">btnStitch</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stitchData</span><span class="p">)</span>
        <span class="n">option</span><span class="o">.</span><span class="n">layout</span><span class="p">()</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">btnStitch</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">leExcludePatches</span> <span class="o">=</span> <span class="n">QLineEdit</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">option</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">leExcludePatches</span><span class="o">.</span><span class="n">setPlaceholderText</span><span class="p">(</span><span class="s1">&#39;Exclude subapertures&#39;</span><span class="p">)</span>
        <span class="n">option</span><span class="o">.</span><span class="n">layout</span><span class="p">()</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">leExcludePatches</span><span class="p">)</span>
        
        <span class="n">option</span><span class="o">.</span><span class="n">layout</span><span class="p">()</span><span class="o">.</span><span class="n">addStretch</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        
        <span class="c1">#Mask options</span>
        <span class="n">option</span> <span class="o">=</span> <span class="n">qt</span><span class="o">.</span><span class="n">QGroupBox</span><span class="p">(</span><span class="s2">&quot;Mask input&quot;</span><span class="p">,</span> <span class="n">panel</span><span class="p">)</span>
        <span class="n">option</span><span class="o">.</span><span class="n">setLayout</span><span class="p">(</span><span class="n">qt</span><span class="o">.</span><span class="n">QVBoxLayout</span><span class="p">())</span>
        <span class="n">panel</span><span class="o">.</span><span class="n">layout</span><span class="p">()</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">option</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">leSaveMask</span> <span class="o">=</span> <span class="n">QLineEdit</span><span class="p">(</span><span class="s1">&#39;Mask save node&#39;</span><span class="p">,</span> <span class="n">option</span><span class="p">)</span>
        <span class="n">option</span><span class="o">.</span><span class="n">layout</span><span class="p">()</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">leSaveMask</span><span class="p">)</span>
        
        <span class="n">btnSelectLoc</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="s1">&#39;Get selected node&#39;</span><span class="p">,</span> <span class="n">option</span><span class="p">)</span>
        <span class="n">btnSelectLoc</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">getSelectedNodeLoc</span><span class="p">)</span>
        <span class="n">option</span><span class="o">.</span><span class="n">layout</span><span class="p">()</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">btnSelectLoc</span><span class="p">)</span>
        
        <span class="n">selMaskType</span> <span class="o">=</span> <span class="n">qt</span><span class="o">.</span><span class="n">QComboBox</span><span class="p">()</span>
        <span class="n">selMaskType</span><span class="o">.</span><span class="n">addItem</span><span class="p">(</span><span class="s2">&quot;Input (Group)&quot;</span><span class="p">,</span> <span class="s1">&#39;ig&#39;</span><span class="p">)</span>
        <span class="n">selMaskType</span><span class="o">.</span><span class="n">addItem</span><span class="p">(</span><span class="s2">&quot;Input (Subapp selected)&quot;</span><span class="p">,</span> <span class="s1">&#39;is&#39;</span><span class="p">)</span>
        <span class="n">selMaskType</span><span class="o">.</span><span class="n">addItem</span><span class="p">(</span><span class="s2">&quot;Output&quot;</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">)</span>
        <span class="n">selMaskType</span><span class="o">.</span><span class="n">activated</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="k">lambda</span> <span class="n">index</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">setMType</span><span class="p">(</span><span class="n">selMaskType</span><span class="o">.</span><span class="n">itemData</span><span class="p">(</span><span class="n">index</span><span class="p">)))</span>
        <span class="n">option</span><span class="o">.</span><span class="n">layout</span><span class="p">()</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">selMaskType</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setMType</span><span class="p">(</span><span class="n">selMaskType</span><span class="o">.</span><span class="n">itemData</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">radDraw</span> <span class="o">=</span> <span class="n">QRadioButton</span><span class="p">(</span><span class="s2">&quot;Draw&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">radDraw</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">option</span><span class="o">.</span><span class="n">layout</span><span class="p">()</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">radDraw</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">radCopy</span> <span class="o">=</span> <span class="n">QRadioButton</span><span class="p">(</span><span class="s2">&quot;Copy&quot;</span><span class="p">)</span>
        <span class="n">option</span><span class="o">.</span><span class="n">layout</span><span class="p">()</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">radCopy</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">radXYSz</span> <span class="o">=</span> <span class="n">QRadioButton</span><span class="p">(</span><span class="s2">&quot;XYSize&quot;</span><span class="p">)</span>
        <span class="n">option</span><span class="o">.</span><span class="n">layout</span><span class="p">()</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">radXYSz</span><span class="p">)</span>
        <span class="n">suboption</span> <span class="o">=</span> <span class="n">qt</span><span class="o">.</span><span class="n">QGroupBox</span><span class="p">(</span><span class="s2">&quot;#pixels width, height&quot;</span><span class="p">,</span> <span class="n">option</span><span class="p">)</span>
        <span class="n">suboption</span><span class="o">.</span><span class="n">setLayout</span><span class="p">(</span><span class="n">qt</span><span class="o">.</span><span class="n">QHBoxLayout</span><span class="p">())</span>
        <span class="n">option</span><span class="o">.</span><span class="n">layout</span><span class="p">()</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">suboption</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">maskWidthPix</span> <span class="o">=</span> <span class="n">QLineEdit</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">suboption</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">maskWidthPix</span><span class="o">.</span><span class="n">setPlaceholderText</span><span class="p">(</span><span class="s1">&#39;width&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">maskWidthPix</span><span class="o">.</span><span class="n">setFixedWidth</span><span class="p">(</span><span class="mi">40</span><span class="p">)</span>
        <span class="n">suboption</span><span class="o">.</span><span class="n">layout</span><span class="p">()</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">maskWidthPix</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">maskHeightPix</span> <span class="o">=</span> <span class="n">QLineEdit</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">suboption</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">maskHeightPix</span><span class="o">.</span><span class="n">setPlaceholderText</span><span class="p">(</span><span class="s1">&#39;height&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">maskHeightPix</span><span class="o">.</span><span class="n">setFixedWidth</span><span class="p">(</span><span class="mi">40</span><span class="p">)</span>
        <span class="n">suboption</span><span class="o">.</span><span class="n">layout</span><span class="p">()</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">maskHeightPix</span><span class="p">)</span>

        <span class="n">suboption</span> <span class="o">=</span> <span class="n">qt</span><span class="o">.</span><span class="n">QGroupBox</span><span class="p">(</span><span class="s2">&quot;offset #pixels width, height&quot;</span><span class="p">,</span> <span class="n">option</span><span class="p">)</span>
        <span class="n">suboption</span><span class="o">.</span><span class="n">setLayout</span><span class="p">(</span><span class="n">qt</span><span class="o">.</span><span class="n">QHBoxLayout</span><span class="p">())</span>
        <span class="n">option</span><span class="o">.</span><span class="n">layout</span><span class="p">()</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">suboption</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">maskWidthPixOffset</span> <span class="o">=</span> <span class="n">QLineEdit</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">suboption</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">maskWidthPixOffset</span><span class="o">.</span><span class="n">setPlaceholderText</span><span class="p">(</span><span class="s1">&#39;width&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">maskWidthPixOffset</span><span class="o">.</span><span class="n">setFixedWidth</span><span class="p">(</span><span class="mi">40</span><span class="p">)</span>
        <span class="n">suboption</span><span class="o">.</span><span class="n">layout</span><span class="p">()</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">maskWidthPixOffset</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">maskHeightPixOffset</span> <span class="o">=</span> <span class="n">QLineEdit</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">suboption</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">maskHeightPixOffset</span><span class="o">.</span><span class="n">setPlaceholderText</span><span class="p">(</span><span class="s1">&#39;height&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">maskHeightPixOffset</span><span class="o">.</span><span class="n">setFixedWidth</span><span class="p">(</span><span class="mi">40</span><span class="p">)</span>
        <span class="n">suboption</span><span class="o">.</span><span class="n">layout</span><span class="p">()</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">maskHeightPixOffset</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">radEdg</span> <span class="o">=</span> <span class="n">QRadioButton</span><span class="p">(</span><span class="s2">&quot;DrawExcludeEdges&quot;</span><span class="p">)</span>
        <span class="n">option</span><span class="o">.</span><span class="n">layout</span><span class="p">()</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">radEdg</span><span class="p">)</span>
        <span class="n">suboption</span> <span class="o">=</span> <span class="n">qt</span><span class="o">.</span><span class="n">QGroupBox</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">option</span><span class="p">)</span>
        <span class="n">suboption</span><span class="o">.</span><span class="n">setLayout</span><span class="p">(</span><span class="n">qt</span><span class="o">.</span><span class="n">QGridLayout</span><span class="p">())</span>
        <span class="n">option</span><span class="o">.</span><span class="n">layout</span><span class="p">()</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">suboption</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">trStep</span> <span class="o">=</span> <span class="n">QLineEdit</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">suboption</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">trStep</span><span class="o">.</span><span class="n">setPlaceholderText</span><span class="p">(</span><span class="s1">&#39;step (mm)&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">trStep</span><span class="o">.</span><span class="n">setFixedWidth</span><span class="p">(</span><span class="mi">40</span><span class="p">)</span>
        <span class="n">suboption</span><span class="o">.</span><span class="n">layout</span><span class="p">()</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">trStep</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
        
        <span class="n">btnSaveMask</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="s1">&#39;Save Mask&#39;</span><span class="p">,</span> <span class="n">option</span><span class="p">)</span>
        <span class="n">btnSaveMask</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">saveMask</span><span class="p">)</span>
        <span class="n">option</span><span class="o">.</span><span class="n">layout</span><span class="p">()</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">btnSaveMask</span><span class="p">)</span>
 
        <span class="n">option</span><span class="o">.</span><span class="n">layout</span><span class="p">()</span><span class="o">.</span><span class="n">addStretch</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        
        <span class="c1">#Results section</span>
        <span class="n">option</span> <span class="o">=</span> <span class="n">qt</span><span class="o">.</span><span class="n">QGroupBox</span><span class="p">(</span><span class="s2">&quot;Results&quot;</span><span class="p">,</span> <span class="n">panel</span><span class="p">)</span>
        <span class="n">option</span><span class="o">.</span><span class="n">setLayout</span><span class="p">(</span><span class="n">qt</span><span class="o">.</span><span class="n">QVBoxLayout</span><span class="p">())</span>
        <span class="n">panel</span><span class="o">.</span><span class="n">layout</span><span class="p">()</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">option</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">avgSelStr</span> <span class="o">=</span> <span class="n">QLineEdit</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">option</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">avgSelStr</span><span class="o">.</span><span class="n">setPlaceholderText</span><span class="p">(</span><span class="s1">&#39;selected scans string&#39;</span><span class="p">)</span>
        <span class="n">option</span><span class="o">.</span><span class="n">layout</span><span class="p">()</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">avgSelStr</span><span class="p">)</span>
        <span class="n">btnAvgScans</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="s1">&#39;Average stitched scans&#39;</span><span class="p">,</span> <span class="n">option</span><span class="p">)</span>
        <span class="n">btnAvgScans</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">avgStitchedScans</span><span class="p">)</span>
        <span class="n">option</span><span class="o">.</span><span class="n">layout</span><span class="p">()</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">btnAvgScans</span><span class="p">)</span>
        <span class="n">btnStdScans</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="s1">&#39;Std stitched scans&#39;</span><span class="p">,</span> <span class="n">option</span><span class="p">)</span>
        <span class="n">btnStdScans</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">getStdScans</span><span class="p">)</span>
        <span class="n">option</span><span class="o">.</span><span class="n">layout</span><span class="p">()</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">btnStdScans</span><span class="p">)</span>

        <span class="n">btnSlp2Hgt</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="s1">&#39;Integrate 2D slopes&#39;</span><span class="p">,</span> <span class="n">option</span><span class="p">)</span>
        <span class="n">btnSlp2Hgt</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">intSlp2Hgt</span><span class="p">)</span>
        <span class="n">option</span><span class="o">.</span><span class="n">layout</span><span class="p">()</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">btnSlp2Hgt</span><span class="p">)</span>

        <span class="n">option</span><span class="o">.</span><span class="n">layout</span><span class="p">()</span><span class="o">.</span><span class="n">addStretch</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

        <span class="n">option</span> <span class="o">=</span> <span class="n">qt</span><span class="o">.</span><span class="n">QGroupBox</span><span class="p">(</span><span class="s2">&quot;Results(2)&quot;</span><span class="p">,</span> <span class="n">panel</span><span class="p">)</span>
        <span class="n">option</span><span class="o">.</span><span class="n">setLayout</span><span class="p">(</span><span class="n">qt</span><span class="o">.</span><span class="n">QVBoxLayout</span><span class="p">())</span>
        <span class="n">panel</span><span class="o">.</span><span class="n">layout</span><span class="p">()</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">option</span><span class="p">)</span>
         
        <span class="n">selDType</span> <span class="o">=</span> <span class="n">qt</span><span class="o">.</span><span class="n">QComboBox</span><span class="p">()</span>
        <span class="n">selDType</span><span class="o">.</span><span class="n">addItem</span><span class="p">(</span><span class="s2">&quot;Slope&quot;</span><span class="p">,</span> <span class="s1">&#39;s&#39;</span><span class="p">)</span>
        <span class="n">selDType</span><span class="o">.</span><span class="n">addItem</span><span class="p">(</span><span class="s2">&quot;Height&quot;</span><span class="p">,</span> <span class="s1">&#39;h&#39;</span><span class="p">)</span>
        <span class="n">selDType</span><span class="o">.</span><span class="n">activated</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="k">lambda</span> <span class="n">index</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">setDType</span><span class="p">(</span><span class="n">selDType</span><span class="o">.</span><span class="n">itemData</span><span class="p">(</span><span class="n">index</span><span class="p">)))</span>
        <span class="n">option</span><span class="o">.</span><span class="n">layout</span><span class="p">()</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">selDType</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setDType</span><span class="p">(</span><span class="n">selDType</span><span class="o">.</span><span class="n">itemData</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">xlim</span> <span class="o">=</span> <span class="n">qt</span><span class="o">.</span><span class="n">QCheckBox</span><span class="p">(</span><span class="s2">&quot;X limits&quot;</span><span class="p">,</span> <span class="n">option</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">xlim</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">option</span><span class="o">.</span><span class="n">layout</span><span class="p">()</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xlim</span><span class="p">)</span>
        <span class="n">suboption</span> <span class="o">=</span> <span class="n">qt</span><span class="o">.</span><span class="n">QGroupBox</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">option</span><span class="p">)</span>
        <span class="n">suboption</span><span class="o">.</span><span class="n">setLayout</span><span class="p">(</span><span class="n">qt</span><span class="o">.</span><span class="n">QHBoxLayout</span><span class="p">())</span>
        <span class="n">option</span><span class="o">.</span><span class="n">layout</span><span class="p">()</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">suboption</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">minX</span> <span class="o">=</span> <span class="n">QLineEdit</span><span class="p">(</span><span class="s2">&quot;-25&quot;</span><span class="p">,</span> <span class="n">suboption</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">minX</span><span class="o">.</span><span class="n">setPlaceholderText</span><span class="p">(</span><span class="s1">&#39;min(mm)&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">minX</span><span class="o">.</span><span class="n">setFixedWidth</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span>
        <span class="n">suboption</span><span class="o">.</span><span class="n">layout</span><span class="p">()</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">minX</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">maxX</span> <span class="o">=</span> <span class="n">QLineEdit</span><span class="p">(</span><span class="s2">&quot;25&quot;</span><span class="p">,</span> <span class="n">suboption</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">maxX</span><span class="o">.</span><span class="n">setPlaceholderText</span><span class="p">(</span><span class="s1">&#39;max(mm)&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">maxX</span><span class="o">.</span><span class="n">setFixedWidth</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span>
        <span class="n">suboption</span><span class="o">.</span><span class="n">layout</span><span class="p">()</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">maxX</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">holdOn</span> <span class="o">=</span> <span class="n">qt</span><span class="o">.</span><span class="n">QCheckBox</span><span class="p">(</span><span class="s2">&quot;Hold on&quot;</span><span class="p">,</span> <span class="n">option</span><span class="p">)</span>
        <span class="c1"># self.holdOn.setChecked(True)</span>
        <span class="n">option</span><span class="o">.</span><span class="n">layout</span><span class="p">()</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">holdOn</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">flipData</span> <span class="o">=</span> <span class="n">qt</span><span class="o">.</span><span class="n">QCheckBox</span><span class="p">(</span><span class="s2">&quot;Flip&quot;</span><span class="p">,</span> <span class="n">option</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">flipData</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">option</span><span class="o">.</span><span class="n">layout</span><span class="p">()</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">flipData</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">resNone</span> <span class="o">=</span> <span class="n">QRadioButton</span><span class="p">(</span><span class="s2">&quot;None&quot;</span><span class="p">,</span> <span class="n">option</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">resNone</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">option</span><span class="o">.</span><span class="n">layout</span><span class="p">()</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">resNone</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">remPoly</span> <span class="o">=</span> <span class="n">QRadioButton</span><span class="p">(</span><span class="s2">&quot;Remove polynomial&quot;</span><span class="p">,</span> <span class="n">option</span><span class="p">)</span>
        <span class="n">option</span><span class="o">.</span><span class="n">layout</span><span class="p">()</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">remPoly</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">remPolyDeg</span> <span class="o">=</span> <span class="n">QLineEdit</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">option</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">remPolyDeg</span><span class="o">.</span><span class="n">setPlaceholderText</span><span class="p">(</span><span class="s1">&#39;degree&#39;</span><span class="p">)</span>
        <span class="n">option</span><span class="o">.</span><span class="n">layout</span><span class="p">()</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">remPolyDeg</span><span class="p">)</span>
        <span class="n">option</span><span class="o">.</span><span class="n">layout</span><span class="p">()</span><span class="o">.</span><span class="n">addStretch</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dispOffset</span> <span class="o">=</span> <span class="n">QLineEdit</span><span class="p">(</span><span class="s2">&quot;1.5&quot;</span><span class="p">,</span> <span class="n">option</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dispOffset</span><span class="o">.</span><span class="n">setPlaceholderText</span><span class="p">(</span><span class="s1">&#39;Display offset scale&#39;</span><span class="p">)</span>
        <span class="n">option</span><span class="o">.</span><span class="n">layout</span><span class="p">()</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dispOffset</span><span class="p">)</span>
        <span class="n">option</span><span class="o">.</span><span class="n">layout</span><span class="p">()</span><span class="o">.</span><span class="n">addStretch</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        
        <span class="c1"># results ellipse section</span>
        <span class="n">option</span> <span class="o">=</span> <span class="n">qt</span><span class="o">.</span><span class="n">QGroupBox</span><span class="p">(</span><span class="s2">&quot;Results (3)&quot;</span><span class="p">,</span> <span class="n">panel</span><span class="p">)</span>
        <span class="n">option</span><span class="o">.</span><span class="n">setLayout</span><span class="p">(</span><span class="n">qt</span><span class="o">.</span><span class="n">QVBoxLayout</span><span class="p">())</span>
        <span class="n">panel</span><span class="o">.</span><span class="n">layout</span><span class="p">()</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">option</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">remEl</span> <span class="o">=</span> <span class="n">QRadioButton</span><span class="p">(</span><span class="s2">&quot;Remove ellipse&quot;</span><span class="p">,</span> <span class="n">option</span><span class="p">)</span>
        <span class="n">option</span><span class="o">.</span><span class="n">layout</span><span class="p">()</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">remEl</span><span class="p">)</span>
        
        <span class="n">selFitType</span> <span class="o">=</span> <span class="n">qt</span><span class="o">.</span><span class="n">QComboBox</span><span class="p">()</span>
        <span class="n">selFitType</span><span class="o">.</span><span class="n">addItem</span><span class="p">(</span><span class="s2">&quot;Fit slopes&quot;</span><span class="p">,</span> <span class="s1">&#39;s_fit&#39;</span><span class="p">)</span>
        <span class="n">selFitType</span><span class="o">.</span><span class="n">addItem</span><span class="p">(</span><span class="s2">&quot;Fit height&quot;</span><span class="p">,</span> <span class="s1">&#39;h_fit&#39;</span><span class="p">)</span>
        <span class="n">selFitType</span><span class="o">.</span><span class="n">activated</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="k">lambda</span> <span class="n">index</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">setFitType</span><span class="p">(</span><span class="n">selFitType</span><span class="o">.</span><span class="n">itemData</span><span class="p">(</span><span class="n">index</span><span class="p">)))</span>
        <span class="n">option</span><span class="o">.</span><span class="n">layout</span><span class="p">()</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">selFitType</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setFitType</span><span class="p">(</span><span class="n">selFitType</span><span class="o">.</span><span class="n">itemData</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
        
        <span class="n">suboption</span> <span class="o">=</span> <span class="n">qt</span><span class="o">.</span><span class="n">QGroupBox</span><span class="p">(</span><span class="s2">&quot;p,q,theta&quot;</span><span class="p">,</span> <span class="n">option</span><span class="p">)</span>
        <span class="n">suboption</span><span class="o">.</span><span class="n">setLayout</span><span class="p">(</span><span class="n">qt</span><span class="o">.</span><span class="n">QHBoxLayout</span><span class="p">())</span>
        <span class="n">option</span><span class="o">.</span><span class="n">layout</span><span class="p">()</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">suboption</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">elP</span> <span class="o">=</span> <span class="n">QLineEdit</span><span class="p">(</span><span class="s2">&quot;183.5&quot;</span><span class="p">,</span> <span class="n">suboption</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">elP</span><span class="o">.</span><span class="n">setPlaceholderText</span><span class="p">(</span><span class="s1">&#39;p&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">elP</span><span class="o">.</span><span class="n">setFixedWidth</span><span class="p">(</span><span class="mi">30</span><span class="p">)</span>
        <span class="n">suboption</span><span class="o">.</span><span class="n">layout</span><span class="p">()</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">elP</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">elQ</span> <span class="o">=</span> <span class="n">QLineEdit</span><span class="p">(</span><span class="s2">&quot;0.1&quot;</span><span class="p">,</span> <span class="n">suboption</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">elQ</span><span class="o">.</span><span class="n">setPlaceholderText</span><span class="p">(</span><span class="s1">&#39;q&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">elQ</span><span class="o">.</span><span class="n">setFixedWidth</span><span class="p">(</span><span class="mi">30</span><span class="p">)</span>
        <span class="n">suboption</span><span class="o">.</span><span class="n">layout</span><span class="p">()</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">elQ</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">elTheta</span> <span class="o">=</span> <span class="n">QLineEdit</span><span class="p">(</span><span class="s2">&quot;14.4&quot;</span><span class="p">,</span> <span class="n">suboption</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">elTheta</span><span class="o">.</span><span class="n">setPlaceholderText</span><span class="p">(</span><span class="s1">&#39;theta&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">elTheta</span><span class="o">.</span><span class="n">setFixedWidth</span><span class="p">(</span><span class="mi">30</span><span class="p">)</span>
        <span class="n">suboption</span><span class="o">.</span><span class="n">layout</span><span class="p">()</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">elTheta</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">selLine</span> <span class="o">=</span> <span class="n">QLineEdit</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">suboption</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">selLine</span><span class="o">.</span><span class="n">setPlaceholderText</span><span class="p">(</span><span class="s1">&#39;Y line&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">selLine</span><span class="o">.</span><span class="n">setFixedWidth</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span>
        <span class="n">option</span><span class="o">.</span><span class="n">layout</span><span class="p">()</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">selLine</span><span class="p">)</span>

        <span class="n">option</span><span class="o">.</span><span class="n">layout</span><span class="p">()</span><span class="o">.</span><span class="n">addStretch</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">btnCompare</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="s1">&#39;Plot results&#39;</span><span class="p">,</span> <span class="n">option</span><span class="p">)</span>
        <span class="n">btnCompare</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">compareResults</span><span class="p">)</span>
        <span class="n">option</span><span class="o">.</span><span class="n">layout</span><span class="p">()</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">btnCompare</span><span class="p">)</span>
        <span class="n">btnDiff</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="s1">&#39;Plot results avg &amp; diff&#39;</span><span class="p">,</span> <span class="n">option</span><span class="p">)</span>
        <span class="n">btnDiff</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">compareAvgDiff</span><span class="p">)</span>
        <span class="n">option</span><span class="o">.</span><span class="n">layout</span><span class="p">()</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">btnDiff</span><span class="p">)</span>
        
        <span class="n">option</span><span class="o">.</span><span class="n">layout</span><span class="p">()</span><span class="o">.</span><span class="n">addStretch</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">btnAddExtCurve</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="s1">&#39;Add external curve&#39;</span><span class="p">,</span> <span class="n">option</span><span class="p">)</span>
        <span class="n">btnAddExtCurve</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">addExtCurve</span><span class="p">)</span>
        <span class="n">option</span><span class="o">.</span><span class="n">layout</span><span class="p">()</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">btnAddExtCurve</span><span class="p">)</span>

        <span class="n">btnAddExtSurf</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="s1">&#39;Add external surface&#39;</span><span class="p">,</span> <span class="n">option</span><span class="p">)</span>
        <span class="n">btnAddExtSurf</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">addExtSurf</span><span class="p">)</span>
        <span class="n">option</span><span class="o">.</span><span class="n">layout</span><span class="p">()</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">btnAddExtSurf</span><span class="p">)</span>

        <span class="n">option</span><span class="o">.</span><span class="n">layout</span><span class="p">()</span><span class="o">.</span><span class="n">addStretch</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        
        <span class="c1">#Results continued</span>
        <span class="n">option</span> <span class="o">=</span> <span class="n">qt</span><span class="o">.</span><span class="n">QGroupBox</span><span class="p">(</span><span class="s2">&quot;Results(4)&quot;</span><span class="p">,</span> <span class="n">panel</span><span class="p">)</span>
        <span class="n">option</span><span class="o">.</span><span class="n">setLayout</span><span class="p">(</span><span class="n">qt</span><span class="o">.</span><span class="n">QVBoxLayout</span><span class="p">())</span>
        <span class="n">panel</span><span class="o">.</span><span class="n">layout</span><span class="p">()</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">option</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">isStd</span> <span class="o">=</span> <span class="n">qt</span><span class="o">.</span><span class="n">QCheckBox</span><span class="p">(</span><span class="s2">&quot;Is data standev?&quot;</span><span class="p">,</span> <span class="n">option</span><span class="p">)</span>
        <span class="n">option</span><span class="o">.</span><span class="n">layout</span><span class="p">()</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">isStd</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">leSaveABBA</span> <span class="o">=</span> <span class="n">QLineEdit</span><span class="p">(</span><span class="s1">&#39;/StitchResults/ABBA/slopes_x&#39;</span><span class="p">,</span> <span class="n">option</span><span class="p">)</span>
        <span class="n">option</span><span class="o">.</span><span class="n">layout</span><span class="p">()</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">leSaveABBA</span><span class="p">)</span>
        
        <span class="n">btnSaveABBA</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="s1">&#39;Save ABBA average&#39;</span><span class="p">,</span> <span class="n">option</span><span class="p">)</span>
        <span class="n">btnSaveABBA</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">saveABBA</span><span class="p">)</span>
        <span class="n">option</span><span class="o">.</span><span class="n">layout</span><span class="p">()</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">btnSaveABBA</span><span class="p">)</span>
        <span class="n">option</span><span class="o">.</span><span class="n">layout</span><span class="p">()</span><span class="o">.</span><span class="n">addStretch</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">isGravityCor</span> <span class="o">=</span> <span class="n">qt</span><span class="o">.</span><span class="n">QCheckBox</span><span class="p">(</span><span class="s2">&quot;correct for gravity&quot;</span><span class="p">,</span> <span class="n">option</span><span class="p">)</span>
        <span class="n">option</span><span class="o">.</span><span class="n">layout</span><span class="p">()</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">isGravityCor</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">leMirLen</span> <span class="o">=</span> <span class="n">QLineEdit</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">option</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">leMirLen</span><span class="o">.</span><span class="n">setPlaceholderText</span><span class="p">(</span><span class="s1">&#39;Mirror length&#39;</span><span class="p">)</span>
        <span class="n">option</span><span class="o">.</span><span class="n">layout</span><span class="p">()</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">leMirLen</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">leMirThickness</span> <span class="o">=</span> <span class="n">QLineEdit</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">option</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">leMirThickness</span><span class="o">.</span><span class="n">setPlaceholderText</span><span class="p">(</span><span class="s1">&#39;Mirror thickness&#39;</span><span class="p">)</span>
        <span class="n">option</span><span class="o">.</span><span class="n">layout</span><span class="p">()</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">leMirThickness</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">leCylDist</span> <span class="o">=</span> <span class="n">QLineEdit</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">option</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">leCylDist</span><span class="o">.</span><span class="n">setPlaceholderText</span><span class="p">(</span><span class="s1">&#39;Distance between cylinders&#39;</span><span class="p">)</span>
        <span class="n">option</span><span class="o">.</span><span class="n">layout</span><span class="p">()</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">leCylDist</span><span class="p">)</span>

        <span class="n">option</span><span class="o">.</span><span class="n">layout</span><span class="p">()</span><span class="o">.</span><span class="n">addStretch</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        
        <span class="c1">#Simulations section</span>
        <span class="n">option</span> <span class="o">=</span> <span class="n">qt</span><span class="o">.</span><span class="n">QGroupBox</span><span class="p">(</span><span class="s2">&quot;Simulations&quot;</span><span class="p">,</span> <span class="n">panel</span><span class="p">)</span>
        <span class="n">option</span><span class="o">.</span><span class="n">setLayout</span><span class="p">(</span><span class="n">qt</span><span class="o">.</span><span class="n">QVBoxLayout</span><span class="p">())</span>
        <span class="n">panel</span><span class="o">.</span><span class="n">layout</span><span class="p">()</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">option</span><span class="p">)</span>
        
        <span class="n">btnSim</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="s1">&#39;Open simulation dialog&#39;</span><span class="p">,</span> <span class="n">option</span><span class="p">)</span>
        <span class="n">btnSim</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">openSimu</span><span class="p">)</span>
        <span class="n">option</span><span class="o">.</span><span class="n">layout</span><span class="p">()</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">btnSim</span><span class="p">)</span>
        
        <span class="n">option</span><span class="o">.</span><span class="n">layout</span><span class="p">()</span><span class="o">.</span><span class="n">addStretch</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        
        <span class="n">panel</span><span class="o">.</span><span class="n">layout</span><span class="p">()</span><span class="o">.</span><span class="n">addStretch</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">panel</span></div>
    
<div class="viewcode-block" id="Hdf5TreeViewExample.setMType"><a class="viewcode-back" href="../../../PyLOSt.ui.html#PyLOSt.ui.hdf5widget_custom.Hdf5TreeViewExample.setMType">[docs]</a>    <span class="k">def</span> <span class="nf">setMType</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">mt</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">maskType</span> <span class="o">=</span> <span class="n">mt</span></div>
<div class="viewcode-block" id="Hdf5TreeViewExample.setDType"><a class="viewcode-back" href="../../../PyLOSt.ui.html#PyLOSt.ui.hdf5widget_custom.Hdf5TreeViewExample.setDType">[docs]</a>    <span class="k">def</span> <span class="nf">setDType</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">dt</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dType</span> <span class="o">=</span> <span class="n">dt</span></div>
<div class="viewcode-block" id="Hdf5TreeViewExample.setFitType"><a class="viewcode-back" href="../../../PyLOSt.ui.html#PyLOSt.ui.hdf5widget_custom.Hdf5TreeViewExample.setFitType">[docs]</a>    <span class="k">def</span> <span class="nf">setFitType</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">ft</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fitType</span> <span class="o">=</span> <span class="n">ft</span></div>

<div class="viewcode-block" id="Hdf5TreeViewExample.saveABBA"><a class="viewcode-back" href="../../../PyLOSt.ui.html#PyLOSt.ui.hdf5widget_custom.Hdf5TreeViewExample.saveABBA">[docs]</a>    <span class="k">def</span> <span class="nf">saveABBA</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Save ABBA average. AB and BA have to be loaded to the plots</span>
<span class="sd">        :return:</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">ndTxt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">leSaveABBA</span><span class="o">.</span><span class="n">text</span><span class="p">()</span>
            <span class="n">saveData</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">if</span> <span class="n">ndTxt</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
                <span class="n">alertMsg</span><span class="p">(</span><span class="s1">&#39;Save location&#39;</span><span class="p">,</span> <span class="s1">&#39;Please enter a save location for ABBA average dataset&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">ndTxt</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">h5Objs</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
                <span class="k">if</span> <span class="n">questionMsg</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                            <span class="s2">&quot;Replace data?&quot;</span><span class="p">,</span>
                            <span class="s2">&quot;A node with the selected name already exist.&quot;</span> <span class="o">+</span>\
                            <span class="s2">&quot;Replace the data in that location?&quot;</span><span class="p">):</span>
                    <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">h5Objs</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">ndTxt</span><span class="p">]</span>
                    <span class="n">saveData</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">saveData</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">saveData</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">widget</span><span class="p">:</span>
                <span class="n">saveData</span> <span class="o">=</span> <span class="kc">False</span>
                <span class="n">alertMsg</span><span class="p">(</span><span class="s1">&#39;No plots open&#39;</span><span class="p">,</span> <span class="s1">&#39;No plots are open in the Plot2D widget. Please select some with &quot;compare selected&quot; button&#39;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">lImgs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">widget</span><span class="o">.</span><span class="n">getAllImages</span><span class="p">()</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">lImgs</span><span class="p">)</span><span class="o">&lt;</span><span class="mi">1</span><span class="p">:</span>
                    <span class="n">saveData</span> <span class="o">=</span> <span class="kc">False</span>
                    <span class="n">alertMsg</span><span class="p">(</span><span class="s1">&#39;Not enough plots&#39;</span><span class="p">,</span> <span class="s1">&#39;Please add atleast 1 images to average&#39;</span><span class="p">)</span>
            
            <span class="k">if</span> <span class="n">saveData</span><span class="p">:</span>
                <span class="n">allData</span> <span class="o">=</span> <span class="kc">None</span>
                <span class="n">cnt</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="n">pix_sz</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pix_sz</span> <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pix_sz</span><span class="p">)</span> <span class="k">else</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>
                <span class="k">for</span> <span class="n">im</span> <span class="ow">in</span> <span class="n">lImgs</span><span class="p">:</span>
                    <span class="n">imData</span> <span class="o">=</span> <span class="n">im</span><span class="o">.</span><span class="n">getData</span><span class="p">()</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">allData</span><span class="p">):</span> <span class="n">allData</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">square</span><span class="p">(</span><span class="n">imData</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">isStd</span><span class="o">.</span><span class="n">isChecked</span><span class="p">()</span> <span class="k">else</span> <span class="n">imData</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>      
                        <span class="k">if</span> <span class="ow">not</span> <span class="nb">bool</span><span class="p">(</span><span class="n">imData</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="n">allData</span><span class="o">.</span><span class="n">shape</span><span class="p">):</span>
                            <span class="n">alertMsg</span><span class="p">(</span><span class="s1">&#39;shape mismatch&#39;</span><span class="p">,</span><span class="s1">&#39;size of images do not match&#39;</span><span class="p">)</span>
                            <span class="k">return</span>     
                        <span class="n">allData</span> <span class="o">=</span> <span class="n">allData</span> <span class="o">+</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">square</span><span class="p">(</span><span class="n">imData</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">isStd</span><span class="o">.</span><span class="n">isChecked</span><span class="p">()</span> <span class="k">else</span> <span class="n">imData</span><span class="p">)</span>
                    <span class="n">cnt</span> <span class="o">=</span> <span class="n">cnt</span> <span class="o">+</span><span class="mi">1</span>
                <span class="k">if</span> <span class="n">cnt</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
                    <span class="n">allData</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">allData</span><span class="o">/</span><span class="n">cnt</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">isStd</span><span class="o">.</span><span class="n">isChecked</span><span class="p">()</span> <span class="k">else</span> <span class="n">allData</span><span class="o">/</span><span class="n">cnt</span>
                    <span class="n">nd</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">h5Objs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">create_dataset</span><span class="p">(</span><span class="n">ndTxt</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="n">allData</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;float32&#39;</span><span class="p">)</span>
                    <span class="n">nd</span><span class="p">[</span><span class="o">...</span><span class="p">]</span> <span class="o">=</span> <span class="n">allData</span>
                    <span class="n">nd</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;pix_size&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pix_sz</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">syncH5Obj</span><span class="p">(</span><span class="n">h5Obj</span><span class="o">=</span><span class="n">nd</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;saveABBA &lt;- Hdf5TreeViewExample&#39;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="p">)</span></div>

<div class="viewcode-block" id="Hdf5TreeViewExample.openSimu"><a class="viewcode-back" href="../../../PyLOSt.ui.html#PyLOSt.ui.hdf5widget_custom.Hdf5TreeViewExample.openSimu">[docs]</a>    <span class="k">def</span> <span class="nf">openSimu</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Open simulation dialog</span>
<span class="sd">        :return:</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">simuDialog</span> <span class="o">=</span> <span class="n">SGSimulations</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">simuDialog</span><span class="o">.</span><span class="n">show</span><span class="p">()</span></div>
        
<div class="viewcode-block" id="Hdf5TreeViewExample.getSelectedNodeLoc"><a class="viewcode-back" href="../../../PyLOSt.ui.html#PyLOSt.ui.hdf5widget_custom.Hdf5TreeViewExample.getSelectedNodeLoc">[docs]</a>    <span class="k">def</span> <span class="nf">getSelectedNodeLoc</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get selected h5 node</span>
<span class="sd">        :return:</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">selected</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__treeview</span><span class="o">.</span><span class="n">selectedH5Nodes</span><span class="p">())</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">selected</span><span class="p">)</span><span class="o">==</span><span class="mi">1</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">selected</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">leSaveMask</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">h5py_object</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">alertMsg</span><span class="p">(</span><span class="s1">&#39;Select save node&#39;</span><span class="p">,</span> <span class="s1">&#39;Please select a node to save the mask&#39;</span><span class="p">)</span>       </div>
        
<div class="viewcode-block" id="Hdf5TreeViewExample.saveMask"><a class="viewcode-back" href="../../../PyLOSt.ui.html#PyLOSt.ui.hdf5widget_custom.Hdf5TreeViewExample.saveMask">[docs]</a>    <span class="k">def</span> <span class="nf">saveMask</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Save mask - input/output mask</span>
<span class="sd">        :return:</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">adv</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__dataViewer</span>
            <span class="n">selObj</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__treeview</span><span class="o">.</span><span class="n">selectedH5Nodes</span><span class="p">())[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">curMask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
            <span class="n">add_mask_flag</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">leSaveMask</span><span class="o">.</span><span class="n">text</span><span class="p">()</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">h5Objs</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
                <span class="n">h5node</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">h5Objs</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="bp">self</span><span class="o">.</span><span class="n">leSaveMask</span><span class="o">.</span><span class="n">text</span><span class="p">()]</span>
                <span class="k">if</span> <span class="s1">&#39;input_mask&#39;</span> <span class="ow">in</span> <span class="n">h5node</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">questionMsg</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                                    <span class="s2">&quot;Select save node&quot;</span><span class="p">,</span>
                                    <span class="s2">&quot;A mask already exist. Replace it?&quot;</span><span class="p">):</span>
                        <span class="k">del</span> <span class="n">h5node</span><span class="p">[</span><span class="s1">&#39;input_mask&#39;</span><span class="p">]</span>
                        <span class="n">add_mask_flag</span> <span class="o">=</span> <span class="kc">True</span>
                    <span class="k">elif</span> <span class="n">questionMsg</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                                      <span class="s2">&quot;Select save node&quot;</span><span class="p">,</span>
                                      <span class="s2">&quot;Multiply to current mask?&quot;</span><span class="p">):</span>
                        <span class="n">curMask</span> <span class="o">=</span> <span class="n">h5node</span><span class="p">[</span><span class="s1">&#39;input_mask&#39;</span><span class="p">][</span><span class="o">...</span><span class="p">]</span>
                        <span class="k">del</span> <span class="n">h5node</span><span class="p">[</span><span class="s1">&#39;input_mask&#39;</span><span class="p">]</span>
                        <span class="n">add_mask_flag</span> <span class="o">=</span> <span class="kc">True</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">add_mask_flag</span> <span class="o">=</span> <span class="kc">False</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">add_mask_flag</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="k">if</span> <span class="n">add_mask_flag</span><span class="p">:</span>
                    <span class="n">aShp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__dataViewer</span><span class="o">.</span><span class="n">data</span><span class="p">()</span><span class="o">.</span><span class="n">shape</span>
                    <span class="n">msk_arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="n">aShp</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;byte&#39;</span><span class="p">)</span>
                    
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__dataViewer</span><span class="o">.</span><span class="n">displayMode</span><span class="p">()</span><span class="o">==</span><span class="n">IMAGE_MODE</span> <span class="ow">and</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">radEdg</span><span class="o">.</span><span class="n">isChecked</span><span class="p">()</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">radDraw</span><span class="o">.</span><span class="n">isChecked</span><span class="p">()):</span><span class="c1"># or self.__dataViewer.displayMode()==STACK_MODE)</span>
                        <span class="n">a</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__dataViewer</span><span class="o">.</span><span class="n">displayedView</span><span class="p">()</span>
                        <span class="n">msk</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">getWidget</span><span class="p">()</span><span class="o">.</span><span class="n">children</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">getMaskToolsDockWidget</span><span class="p">()</span><span class="o">.</span><span class="n">getSelectionMask</span><span class="p">()</span> <span class="c1">#or use adv.findChild(silx.gui.plot.MaskToolsWidget.MaskToolsDockWidget).getSelectionMask()</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">radXYSz</span><span class="o">.</span><span class="n">isChecked</span><span class="p">():</span>
                        <span class="n">xlen</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">maskWidthPix</span><span class="o">.</span><span class="n">text</span><span class="p">())</span>
                        <span class="n">ylen</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">maskHeightPix</span><span class="o">.</span><span class="n">text</span><span class="p">())</span>
                        <span class="n">xof</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">maskWidthPixOffset</span><span class="o">.</span><span class="n">text</span><span class="p">())</span>
                        <span class="n">yof</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">maskHeightPixOffset</span><span class="o">.</span><span class="n">text</span><span class="p">())</span>
                        <span class="n">xind</span> <span class="o">=</span> <span class="n">xof</span><span class="o">+</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="n">xlen</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="n">xlen</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">+</span><span class="n">aShp</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
                        <span class="n">yind</span> <span class="o">=</span> <span class="n">yof</span><span class="o">+</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="n">ylen</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="n">ylen</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">+</span><span class="n">aShp</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
                        <span class="k">if</span> <span class="n">msk_arr</span><span class="o">.</span><span class="n">ndim</span><span class="o">==</span><span class="mi">3</span><span class="p">:</span>
                            <span class="n">msk_arr</span> <span class="o">=</span> <span class="n">msk_arr</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="c1"># reduce dimentions to 2</span>
                        <span class="n">ind</span> <span class="o">=</span> <span class="p">[</span><span class="nb">slice</span><span class="p">(</span><span class="kc">None</span><span class="p">)]</span><span class="o">*</span><span class="mi">2</span><span class="c1">#msk_arr.ndim</span>
                        <span class="n">msk_arr</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span><span class="o">=</span><span class="mi">0</span>
                        <span class="n">ind</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">xind</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">,:]</span>
                        <span class="n">ind</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">yind</span><span class="p">[:,</span><span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">]</span>
                        <span class="n">msk_arr</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span><span class="o">=</span><span class="mi">1</span>
                    <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">radCopy</span><span class="o">.</span><span class="n">isChecked</span><span class="p">():</span>
                        <span class="n">msk_arr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__dataViewer</span><span class="o">.</span><span class="n">data</span><span class="p">()</span>
                    <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">radEdg</span><span class="o">.</span><span class="n">isChecked</span><span class="p">():</span>
                        <span class="n">selDim</span> <span class="o">=</span> <span class="n">adv</span><span class="o">.</span><span class="n">findChild</span><span class="p">(</span><span class="n">silx</span><span class="o">.</span><span class="n">gui</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">NumpyAxesSelector</span><span class="o">.</span><span class="n">NumpyAxesSelector</span><span class="p">)</span><span class="o">.</span><span class="n">selection</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span> <span class="c1"># selected dimension 0</span>
                        
                        <span class="k">if</span> <span class="s1">&#39;motor_X&#39;</span> <span class="ow">in</span> <span class="n">selObj</span><span class="o">.</span><span class="n">parent</span><span class="p">:</span>
                            <span class="n">entry</span> <span class="o">=</span> <span class="n">h5node</span><span class="p">[</span><span class="s1">&#39;measurement_entry&#39;</span><span class="p">][</span><span class="o">...</span><span class="p">]</span>
                            <span class="n">pix_sz</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">h5Objs</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="nb">str</span><span class="p">(</span><span class="n">entry</span><span class="p">)][</span><span class="s1">&#39;Instrument/resolution&#39;</span><span class="p">][</span><span class="o">...</span><span class="p">]</span>
                            <span class="n">translation_step</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">trStep</span><span class="o">.</span><span class="n">text</span><span class="p">())</span>
                            <span class="n">mxArr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getMxArr</span><span class="p">(</span><span class="n">selObj</span><span class="o">.</span><span class="n">parent</span><span class="p">[</span><span class="s1">&#39;motor_X&#39;</span><span class="p">][</span><span class="o">...</span><span class="p">],</span> <span class="n">translation_step</span><span class="p">,</span> <span class="n">pix_sz</span><span class="p">)</span>
                            <span class="n">mxArr</span> <span class="o">=</span> <span class="n">mxArr</span> <span class="o">-</span> <span class="n">mxArr</span><span class="p">[</span><span class="n">selDim</span><span class="p">]</span>
                            <span class="k">for</span> <span class="n">j</span><span class="p">,</span><span class="n">x</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">mxArr</span><span class="p">):</span>
                                <span class="n">msk_j</span> <span class="o">=</span> <span class="n">shift</span><span class="p">(</span><span class="n">msk</span><span class="p">,[</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="n">x</span><span class="p">],</span><span class="n">cval</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
                                <span class="n">msk_arr</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">msk_j</span>
                            <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">curMask</span><span class="p">):</span>
                                <span class="n">msk_arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">msk_arr</span><span class="p">,</span> <span class="n">curMask</span><span class="p">)</span>
                        
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">maskType</span><span class="o">==</span><span class="s1">&#39;ig&#39;</span><span class="p">:</span>
                        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">radDraw</span><span class="o">.</span><span class="n">isChecked</span><span class="p">():</span>
                            <span class="n">msk_arr</span> <span class="o">=</span> <span class="n">msk</span>
                            <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">curMask</span><span class="p">):</span>
                                <span class="n">msk_arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">msk</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span> <span class="n">curMask</span><span class="p">)</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">curMask</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span><span class="o">!=</span><span class="mi">2</span> <span class="k">else</span> <span class="n">np</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">msk</span><span class="p">,</span> <span class="n">curMask</span><span class="p">)</span>
                        <span class="n">h5node</span><span class="p">[</span><span class="s1">&#39;input_mask&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">msk_arr</span>
                    <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">maskType</span><span class="o">==</span><span class="s1">&#39;is&#39;</span><span class="p">:</span>
                        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">radDraw</span><span class="o">.</span><span class="n">isChecked</span><span class="p">():</span>
                            <span class="n">sel</span> <span class="o">=</span> <span class="n">adv</span><span class="o">.</span><span class="n">findChild</span><span class="p">(</span><span class="n">silx</span><span class="o">.</span><span class="n">gui</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">NumpyAxesSelector</span><span class="o">.</span><span class="n">NumpyAxesSelector</span><span class="p">)</span><span class="o">.</span><span class="n">selection</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span> <span class="c1"># selected dimension 0</span>
                            <span class="n">msk_arr</span><span class="p">[</span><span class="n">sel</span><span class="p">]</span> <span class="o">=</span> <span class="n">msk</span>
                            <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">curMask</span><span class="p">):</span>
                                <span class="n">msk_arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">msk_arr</span><span class="p">,</span> <span class="n">curMask</span><span class="p">)</span>
                        <span class="n">h5node</span><span class="p">[</span><span class="s1">&#39;input_mask&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">msk_arr</span>
                    <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">maskType</span><span class="o">==</span><span class="s1">&#39;o&#39;</span><span class="p">:</span>
                        <span class="k">if</span> <span class="s1">&#39;output_mask&#39;</span> <span class="ow">in</span> <span class="n">h5node</span><span class="p">:</span> <span class="k">del</span> <span class="n">h5node</span><span class="p">[</span><span class="s1">&#39;output_mask&#39;</span><span class="p">]</span>
                        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">radDraw</span><span class="o">.</span><span class="n">isChecked</span><span class="p">():</span>
                            <span class="n">msk_arr</span> <span class="o">=</span> <span class="n">msk</span>
                        <span class="n">h5node</span><span class="p">[</span><span class="s1">&#39;output_mask&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">msk_arr</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">syncH5Obj</span><span class="p">(</span><span class="n">h5Obj</span><span class="o">=</span><span class="n">h5node</span><span class="p">)</span>
                <span class="n">alertMsg</span><span class="p">(</span><span class="s1">&#39;Select save node&#39;</span><span class="p">,</span> <span class="s1">&#39;Mask saved successfully&#39;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">alertMsg</span><span class="p">(</span><span class="s1">&#39;Select save node&#39;</span><span class="p">,</span> <span class="s1">&#39;Entered node does not exist&#39;</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;saveMask &lt;- Hdf5TreeViewExample&#39;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="p">)</span></div>
    
<div class="viewcode-block" id="Hdf5TreeViewExample.getEdgeExclMask"><a class="viewcode-back" href="../../../PyLOSt.ui.html#PyLOSt.ui.hdf5widget_custom.Hdf5TreeViewExample.getEdgeExclMask">[docs]</a>    <span class="k">def</span> <span class="nf">getEdgeExclMask</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Create mask with specified number of edge pixels excluded</span>
<span class="sd">        :return:</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">le</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">maskLeftEdgePix</span><span class="o">.</span><span class="n">text</span><span class="p">())</span>
        <span class="n">re</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">maskRightEdgePix</span><span class="o">.</span><span class="n">text</span><span class="p">())</span>
        <span class="n">te</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">maskTopEdgePix</span><span class="o">.</span><span class="n">text</span><span class="p">())</span>
        <span class="n">be</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">maskBottomEdgePix</span><span class="o">.</span><span class="n">text</span><span class="p">())</span>
        
        <span class="n">data</span>        <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__dataViewer</span><span class="o">.</span><span class="n">data</span><span class="p">()</span>
        <span class="n">msk_arr</span>     <span class="o">=</span> <span class="o">~</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="c1">############# need to work on it</span>
        <span class="n">ind</span>         <span class="o">=</span> <span class="p">[</span><span class="nb">slice</span><span class="p">(</span><span class="kc">None</span><span class="p">)]</span><span class="o">*</span><span class="n">msk_arr</span><span class="o">.</span><span class="n">ndim</span>
        <span class="n">mask_x</span>      <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">msk_arr</span><span class="p">,</span><span class="n">axis</span><span class="o">=-</span><span class="mi">2</span><span class="p">)</span> <span class="c1"># to find edges along X-axis/ last dimensions</span>
        <span class="c1">#################################</span>
        <span class="k">return</span> <span class="n">msk_arr</span></div>
    
<div class="viewcode-block" id="Hdf5TreeViewExample.getMxArr"><a class="viewcode-back" href="../../../PyLOSt.ui.html#PyLOSt.ui.hdf5widget_custom.Hdf5TreeViewExample.getMxArr">[docs]</a>    <span class="k">def</span> <span class="nf">getMxArr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mXArr</span><span class="p">,</span> <span class="n">stitch_step</span><span class="p">,</span> <span class="n">pix_sz</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get translation offset array in pixels</span>

<span class="sd">        :param mXArr: Translation offsets in mm</span>
<span class="sd">        :param stitch_step: Stitching step in mm</span>
<span class="sd">        :param pix_sz: Pixel size</span>
<span class="sd">        :return:</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">mXArr</span><span class="p">)):</span>                                                         <span class="c1">#use stitch step if no data is available</span>
            <span class="n">mXArr</span>                   <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">mXArr</span><span class="p">))</span><span class="o">*</span><span class="n">stitch_step</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">mXArr</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.0</span><span class="o">*</span><span class="n">mXArr</span> <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">mXArr</span><span class="p">)</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">)</span> <span class="k">else</span> <span class="n">mXArr</span>
            
        <span class="n">mXArr_rel</span>                   <span class="o">=</span> <span class="n">mXArr</span><span class="o">-</span><span class="nb">min</span><span class="p">(</span><span class="n">mXArr</span><span class="p">)</span>                                      <span class="c1">#usually in mm</span>
        <span class="n">mXArr_rp</span>                    <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">rint</span><span class="p">(</span><span class="n">mXArr_rel</span><span class="o">/</span><span class="n">pix_sz</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>          <span class="c1"># pixel offsets from start (rp: relative &amp; pixelwise)</span>
        <span class="k">return</span> <span class="n">mXArr_rp</span></div>
        
<div class="viewcode-block" id="Hdf5TreeViewExample.avgStitchedScans"><a class="viewcode-back" href="../../../PyLOSt.ui.html#PyLOSt.ui.hdf5widget_custom.Hdf5TreeViewExample.avgStitchedScans">[docs]</a>    <span class="k">def</span> <span class="nf">avgStitchedScans</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Average stitched scans</span>
<span class="sd">        :return:</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">selected</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__treeview</span><span class="o">.</span><span class="n">selectedH5Nodes</span><span class="p">())</span>
        <span class="n">quserstr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">avgSelStr</span><span class="o">.</span><span class="n">text</span><span class="p">()</span>

        <span class="k">for</span> <span class="n">it</span> <span class="ow">in</span> <span class="n">selected</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">it</span><span class="o">.</span><span class="n">ntype</span> <span class="ow">is</span> <span class="n">h5py</span><span class="o">.</span><span class="n">Group</span><span class="p">:</span>
                <span class="n">h5stgrp</span> <span class="o">=</span> <span class="n">it</span><span class="o">.</span><span class="n">h5py_object</span>  
                <span class="n">isSlopeStitch</span> <span class="o">=</span> <span class="kc">True</span> <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;data_type&#39;</span> <span class="ow">in</span> <span class="n">h5stgrp</span><span class="o">.</span><span class="n">attrs</span><span class="p">)</span> <span class="ow">and</span> <span class="n">h5stgrp</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;data_type&#39;</span><span class="p">]</span><span class="o">==</span><span class="s2">&quot;slope&quot;</span> <span class="k">else</span> <span class="kc">False</span>
                <span class="n">avgStitchedScans</span><span class="p">(</span><span class="n">h5stgrp</span><span class="p">,</span> <span class="n">isSlopeStitch</span><span class="o">=</span><span class="n">isSlopeStitch</span><span class="p">,</span> <span class="n">quser</span><span class="o">=</span><span class="n">quserstr</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">selected</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">syncH5Obj</span><span class="p">(</span><span class="n">it</span><span class="o">.</span><span class="n">h5py_object</span><span class="p">)</span></div>

<div class="viewcode-block" id="Hdf5TreeViewExample.getStdScans"><a class="viewcode-back" href="../../../PyLOSt.ui.html#PyLOSt.ui.hdf5widget_custom.Hdf5TreeViewExample.getStdScans">[docs]</a>    <span class="k">def</span> <span class="nf">getStdScans</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get standard deviation of scans</span>
<span class="sd">        :return:</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">selected</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__treeview</span><span class="o">.</span><span class="n">selectedH5Nodes</span><span class="p">())</span>

        <span class="k">for</span> <span class="n">it</span> <span class="ow">in</span> <span class="n">selected</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">it</span><span class="o">.</span><span class="n">ntype</span> <span class="ow">is</span> <span class="n">h5py</span><span class="o">.</span><span class="n">Group</span><span class="p">:</span>
                <span class="n">h5stgrp</span> <span class="o">=</span> <span class="n">it</span><span class="o">.</span><span class="n">h5py_object</span>
                <span class="n">isSlopeStitch</span> <span class="o">=</span> <span class="kc">True</span> <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;data_type&#39;</span> <span class="ow">in</span> <span class="n">h5stgrp</span><span class="o">.</span><span class="n">attrs</span><span class="p">)</span> <span class="ow">and</span> <span class="n">h5stgrp</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;data_type&#39;</span><span class="p">]</span><span class="o">==</span><span class="s2">&quot;slope&quot;</span> <span class="k">else</span> <span class="kc">False</span>

                <span class="k">if</span> <span class="s1">&#39;measurement_entry&#39;</span> <span class="ow">in</span> <span class="n">h5stgrp</span><span class="p">:</span>
                    <span class="n">entryNm</span>                     <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">it</span><span class="o">.</span><span class="n">h5py_object</span><span class="p">[</span><span class="s1">&#39;measurement_entry&#39;</span><span class="p">][</span><span class="o">...</span><span class="p">])</span>
                    <span class="n">pix_sz</span>                      <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">h5Objs</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">entryNm</span><span class="p">][</span><span class="s1">&#39;Instrument/resolution&#39;</span><span class="p">][</span><span class="o">...</span><span class="p">]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">alertMsg</span><span class="p">(</span><span class="s1">&#39;Pix size&#39;</span><span class="p">,</span> <span class="s1">&#39;pix size not found. please select a process with measurement entry&#39;</span><span class="p">)</span>
                    <span class="k">return</span>

                <span class="n">getStd</span><span class="p">(</span><span class="n">h5stgrp</span><span class="p">,</span> <span class="n">isSlopeStitch</span><span class="o">=</span><span class="n">isSlopeStitch</span><span class="p">,</span> <span class="n">pix_sz</span><span class="o">=</span><span class="n">pix_sz</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">selected</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">syncH5Obj</span><span class="p">(</span><span class="n">it</span><span class="o">.</span><span class="n">h5py_object</span><span class="p">)</span></div>

<div class="viewcode-block" id="Hdf5TreeViewExample.intSlp2Hgt"><a class="viewcode-back" href="../../../PyLOSt.ui.html#PyLOSt.ui.hdf5widget_custom.Hdf5TreeViewExample.intSlp2Hgt">[docs]</a>    <span class="k">def</span> <span class="nf">intSlp2Hgt</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Integrate slope to height</span>
<span class="sd">        :return:</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">selected</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__treeview</span><span class="o">.</span><span class="n">selectedH5Nodes</span><span class="p">())</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">it</span> <span class="ow">in</span> <span class="n">selected</span><span class="p">:</span>
                <span class="n">ith5</span> <span class="o">=</span> <span class="n">it</span><span class="o">.</span><span class="n">h5py_object</span>
                <span class="k">if</span> <span class="s1">&#39;scan_avg&#39;</span> <span class="ow">in</span> <span class="n">ith5</span><span class="p">:</span>
                    <span class="n">ith5_main</span> <span class="o">=</span> <span class="n">ith5</span><span class="p">[</span><span class="s1">&#39;scan_avg&#39;</span><span class="p">]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">ith5_main</span> <span class="o">=</span> <span class="n">ith5</span>
                <span class="k">if</span> <span class="s1">&#39;measurement_entry&#39;</span> <span class="ow">in</span> <span class="n">ith5</span><span class="p">:</span>
                    <span class="n">entryNm</span>                     <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">it</span><span class="o">.</span><span class="n">h5py_object</span><span class="p">[</span><span class="s1">&#39;measurement_entry&#39;</span><span class="p">][</span><span class="o">...</span><span class="p">])</span>
                    <span class="n">pix_sz</span>                      <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">h5Objs</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">entryNm</span><span class="p">][</span><span class="s1">&#39;Instrument/resolution&#39;</span><span class="p">][</span><span class="o">...</span><span class="p">]</span>
                <span class="k">elif</span> <span class="s1">&#39;pix_size&#39;</span> <span class="ow">in</span> <span class="n">ith5_main</span><span class="o">.</span><span class="n">attrs</span><span class="p">:</span>
                    <span class="n">pix_sz</span>                      <span class="o">=</span> <span class="n">ith5_main</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;pix_size&#39;</span><span class="p">]</span>
                    <span class="n">pix_sz</span>                      <span class="o">=</span> <span class="n">getPixSz2D</span><span class="p">(</span><span class="n">pix_sz</span><span class="p">)</span>
                <span class="k">elif</span> <span class="s1">&#39;slopes_x&#39;</span> <span class="ow">in</span> <span class="n">ith5_main</span> <span class="ow">and</span> <span class="s1">&#39;pix_size&#39;</span> <span class="ow">in</span> <span class="n">ith5_main</span><span class="p">[</span><span class="s1">&#39;slopes_x&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">attrs</span><span class="p">:</span>
                    <span class="n">pix_sz</span>                      <span class="o">=</span> <span class="n">ith5_main</span><span class="p">[</span><span class="s1">&#39;slopes_x&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;pix_size&#39;</span><span class="p">]</span>
                    <span class="n">pix_sz</span>                      <span class="o">=</span> <span class="n">getPixSz2D</span><span class="p">(</span><span class="n">pix_sz</span><span class="p">)</span>
                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">leSaveMask</span><span class="o">.</span><span class="n">text</span><span class="p">()</span><span class="o">!=</span><span class="s1">&#39;&#39;</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">leSaveMask</span><span class="o">.</span><span class="n">text</span><span class="p">()</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">h5Objs</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
                    <span class="n">pix_sz</span>                      <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">h5Objs</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="bp">self</span><span class="o">.</span><span class="n">leSaveMask</span><span class="o">.</span><span class="n">text</span><span class="p">()][</span><span class="s1">&#39;Instrument/resolution&#39;</span><span class="p">][</span><span class="o">...</span><span class="p">]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">alertMsg</span><span class="p">(</span><span class="s1">&#39;Pix size&#39;</span><span class="p">,</span> <span class="s1">&#39;pix size not found&#39;</span><span class="p">)</span>
                    <span class="k">return</span>

                <span class="k">if</span> <span class="s1">&#39;slopes_x&#39;</span> <span class="ow">in</span> <span class="n">ith5_main</span> <span class="ow">and</span> <span class="s1">&#39;slopes_y&#39;</span> <span class="ow">in</span> <span class="n">ith5_main</span><span class="p">:</span>
                    <span class="n">sx</span>                          <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">ith5_main</span><span class="p">[</span><span class="s1">&#39;slopes_x&#39;</span><span class="p">][</span><span class="o">...</span><span class="p">])</span>
                    <span class="n">sy</span>                          <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">ith5_main</span><span class="p">[</span><span class="s1">&#39;slopes_y&#39;</span><span class="p">][</span><span class="o">...</span><span class="p">])</span>
                    <span class="n">omsk</span>                        <span class="o">=</span> <span class="o">~</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">sx</span><span class="p">)</span> <span class="o">&amp;</span> <span class="o">~</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">sy</span><span class="p">)</span> 
                    <span class="n">shp</span>                         <span class="o">=</span> <span class="n">sx</span><span class="o">.</span><span class="n">shape</span>
                    <span class="k">if</span> <span class="s1">&#39;output_mask&#39;</span> <span class="ow">in</span> <span class="n">ith5_main</span><span class="p">:</span>
                        <span class="n">omsk</span>                    <span class="o">=</span> <span class="n">ith5_main</span><span class="p">[</span><span class="s1">&#39;output_mask&#39;</span><span class="p">][</span><span class="o">...</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">bool</span><span class="p">)</span>
                    <span class="n">sx</span>                      <span class="o">=</span> <span class="n">sx</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ix_</span><span class="p">(</span><span class="n">omsk</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span><span class="n">omsk</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">))]</span>
                    <span class="n">sy</span>                      <span class="o">=</span> <span class="n">sy</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ix_</span><span class="p">(</span><span class="n">omsk</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span><span class="n">omsk</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">))]</span>
                    <span class="n">shp_msk</span>                     <span class="o">=</span> <span class="n">sx</span><span class="o">.</span><span class="n">shape</span>
                    <span class="n">center</span>                      <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">shp_msk</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>

                    <span class="n">x</span>                           <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">sx</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span><span class="o">*</span><span class="n">pix_sz</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                    <span class="n">x</span>                           <span class="o">=</span> <span class="n">x</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">nanmean</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
                    <span class="n">z_line</span>                      <span class="o">=</span> <span class="n">integrate</span><span class="o">.</span><span class="n">cumtrapz</span><span class="p">(</span><span class="n">sx</span><span class="p">[</span><span class="n">center</span><span class="p">,:],</span> <span class="n">x</span><span class="p">,</span> <span class="n">pix_sz</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> 
                    <span class="k">if</span> <span class="s1">&#39;height_integrated_line&#39;</span> <span class="ow">in</span> <span class="n">ith5_main</span><span class="p">:</span>
                        <span class="k">del</span> <span class="n">ith5_main</span><span class="p">[</span><span class="s1">&#39;height_integrated_line&#39;</span><span class="p">]</span>
                    <span class="n">ith5_main</span><span class="p">[</span><span class="s1">&#39;height_integrated_line&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">z_line</span>
                    
                    <span class="c1"># resample data along X</span>
                    <span class="c1">#sx                          = resample(sx,sx.shape[1]*20,axis=1)</span>
                    <span class="c1">#sy                          = resample(sy,sy.shape[1]*20,axis=1)</span>
                    <span class="n">shp_r</span>                       <span class="o">=</span> <span class="n">sx</span><span class="o">.</span><span class="n">shape</span>
                    <span class="n">syt</span><span class="p">,</span><span class="n">sxt</span>                     <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mgrid</span><span class="p">[</span><span class="o">-</span><span class="n">shp_r</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="mi">2</span><span class="p">:</span><span class="n">shp_r</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="n">shp_r</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="mi">2</span><span class="p">:</span><span class="n">shp_r</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="mi">100</span>
                    <span class="n">sx</span>                          <span class="o">=</span> <span class="n">sx</span> <span class="o">-</span> <span class="n">sx</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">shp_r</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span><span class="nb">int</span><span class="p">(</span><span class="n">shp_r</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="mi">2</span><span class="p">)]</span>
                    <span class="n">sy</span>                          <span class="o">=</span> <span class="n">sy</span> <span class="o">-</span> <span class="n">sy</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">shp_r</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span><span class="nb">int</span><span class="p">(</span><span class="n">shp_r</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="mi">2</span><span class="p">)]</span>
                    <span class="n">mv</span>                          <span class="o">=</span> <span class="mi">1</span><span class="c1">#(max(sx.flatten())+max(sy.flatten()))/2</span>
                    <span class="n">z</span>                           <span class="o">=</span> <span class="n">mv</span><span class="o">*</span><span class="n">slp2hgt</span><span class="p">(</span><span class="n">sx</span><span class="o">/</span><span class="n">mv</span><span class="p">,</span> <span class="n">sy</span><span class="o">/</span><span class="n">mv</span><span class="p">,</span> <span class="n">pix_sz</span><span class="p">,</span><span class="n">method</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
                    <span class="c1">#z                           = resample(z,int(z.shape[1]/20),axis=1)</span>
                    <span class="n">zf</span>                          <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="n">shp</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;float&#39;</span><span class="p">)</span>
                    <span class="n">zf</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ix_</span><span class="p">(</span><span class="n">omsk</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span><span class="n">omsk</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">))]</span> <span class="o">=</span> <span class="n">z</span>
                    <span class="k">if</span> <span class="s1">&#39;height_integrated&#39;</span> <span class="ow">in</span> <span class="n">ith5_main</span><span class="p">:</span>
                        <span class="k">del</span> <span class="n">ith5_main</span><span class="p">[</span><span class="s1">&#39;height_integrated&#39;</span><span class="p">]</span>
                    <span class="n">ith5_main</span><span class="p">[</span><span class="s1">&#39;height_integrated&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">zf</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">selected</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">syncH5Obj</span><span class="p">(</span><span class="n">it</span><span class="o">.</span><span class="n">h5py_object</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;intSlp2Hgt &lt;- Hdf5TreeViewExample&#39;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="p">)</span></div>
            
<div class="viewcode-block" id="Hdf5TreeViewExample.compareAvgDiff"><a class="viewcode-back" href="../../../PyLOSt.ui.html#PyLOSt.ui.hdf5widget_custom.Hdf5TreeViewExample.compareAvgDiff">[docs]</a>    <span class="k">def</span> <span class="nf">compareAvgDiff</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Create average and difference of the images that are open</span>

<span class="sd">        :return:</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dataPlots</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">initAvgDiffPlots</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">plot3</span><span class="o">.</span><span class="n">setGraphTitle</span><span class="p">(</span><span class="s1">&#39;Difference to first plot&#39;</span><span class="p">)</span>
                <span class="c1"># difference to first plot</span>
                <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">obj</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dataPlots</span><span class="p">):</span>
                    <span class="k">if</span> <span class="n">i</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
                        <span class="n">obj_1</span> <span class="o">=</span> <span class="n">obj</span>
                        <span class="n">x1</span> <span class="o">=</span> <span class="n">obj</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span>
                        <span class="k">continue</span>

                    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">obj</span><span class="p">[</span><span class="s1">&#39;dataLine&#39;</span><span class="p">])</span><span class="o">==</span><span class="nb">len</span><span class="p">(</span><span class="n">obj_1</span><span class="p">[</span><span class="s1">&#39;dataLine&#39;</span><span class="p">]):</span>
                        <span class="n">diffLine</span> <span class="o">=</span> <span class="n">obj</span><span class="p">[</span><span class="s1">&#39;dataLine&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">obj_1</span><span class="p">[</span><span class="s1">&#39;dataLine&#39;</span><span class="p">]</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">dataLine_interp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">interp</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span><span class="n">obj</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">],</span><span class="n">obj</span><span class="p">[</span><span class="s1">&#39;dataLine&#39;</span><span class="p">])</span>
                        <span class="n">diffLine</span> <span class="o">=</span> <span class="n">dataLine_interp</span> <span class="o">-</span> <span class="n">obj_1</span><span class="p">[</span><span class="s1">&#39;dataLine&#39;</span><span class="p">]</span>
                    <span class="n">legnd</span> <span class="o">=</span> <span class="n">obj</span><span class="p">[</span><span class="s1">&#39;legend&#39;</span><span class="p">]</span><span class="o">+</span><span class="s1">&#39; Diff: rms = &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">around</span><span class="p">(</span><span class="n">rms</span><span class="p">(</span><span class="n">diffLine</span><span class="p">),</span> <span class="n">decimals</span><span class="o">=</span><span class="mi">3</span><span class="p">))</span><span class="o">+</span><span class="s1">&#39; &#39;</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">plot3</span><span class="o">.</span><span class="n">addCurve</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">diffLine</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="n">legnd</span><span class="p">,</span> <span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;X (mm)&#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">alertMsg</span><span class="p">(</span><span class="s1">&#39;No plots available&#39;</span><span class="p">,</span>
                         <span class="s1">&#39;No plots are available. Please select some with &quot;compare selected&quot; button&#39;</span><span class="p">)</span>

        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;compareAvgDiff &lt;- Hdf5TreeViewExample&#39;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="p">)</span></div>
        
<div class="viewcode-block" id="Hdf5TreeViewExample.initAvgDiffPlots"><a class="viewcode-back" href="../../../PyLOSt.ui.html#PyLOSt.ui.hdf5widget_custom.Hdf5TreeViewExample.initAvgDiffPlots">[docs]</a>    <span class="k">def</span> <span class="nf">initAvgDiffPlots</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initialize plot widgets for plotting average and difference</span>
<span class="sd">        :return:</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">colormap</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;temperature&#39;</span><span class="p">,</span> <span class="s1">&#39;normalization&#39;</span><span class="p">:</span> <span class="s1">&#39;linear&#39;</span><span class="p">,</span>
        <span class="s1">&#39;autoscale&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s1">&#39;vmin&#39;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span> <span class="s1">&#39;vmax&#39;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">}</span>
<span class="c1">#         self.widget2 = Plot2D()</span>
<span class="c1">#         self.widget2.setDefaultColormap(colormap)</span>
<span class="c1">#         self.widget2.show()</span>
<span class="c1">#         self.widget3 = Plot2D()</span>
<span class="c1">#         self.widget3.setDefaultColormap(colormap)</span>
<span class="c1">#         self.widget3.setKeepDataAspectRatio(True)</span>
<span class="c1">#         self.widget3.show()</span>
<span class="c1">#         self.plot2 = Plot1D()</span>
<span class="c1">#         self.plot2.show()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot3</span> <span class="o">=</span> <span class="n">Plot1D</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot3</span><span class="o">.</span><span class="n">show</span><span class="p">()</span></div>

<div class="viewcode-block" id="Hdf5TreeViewExample.addExtSurf"><a class="viewcode-back" href="../../../PyLOSt.ui.html#PyLOSt.ui.hdf5widget_custom.Hdf5TreeViewExample.addExtSurf">[docs]</a>    <span class="k">def</span> <span class="nf">addExtSurf</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">extFnm</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">QFileDialog</span><span class="o">.</span><span class="n">getOpenFileName</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="s1">&#39;Open file&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
            <span class="c1"># initialize plots</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">initializePlotWidgets</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">extFnm</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;.dat&#39;</span><span class="p">):</span>
                <span class="n">d</span> <span class="o">=</span> <span class="n">readDatFile</span><span class="p">(</span><span class="n">extFnm</span><span class="p">)</span>
                <span class="n">extData</span> <span class="o">=</span> <span class="n">d</span><span class="p">[</span><span class="s1">&#39;height_nm&#39;</span><span class="p">]</span>
                <span class="n">pix_sz</span> <span class="o">=</span> <span class="p">[</span><span class="n">d</span><span class="p">[</span><span class="s1">&#39;CameraRes&#39;</span><span class="p">]</span><span class="o">*</span><span class="mf">1e3</span><span class="p">,</span><span class="n">d</span><span class="p">[</span><span class="s1">&#39;CameraRes&#39;</span><span class="p">]</span><span class="o">*</span><span class="mf">1e3</span><span class="p">]</span> <span class="c1">#mm</span>
            <span class="k">if</span> <span class="n">extFnm</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;.datx&#39;</span><span class="p">):</span>
                <span class="n">d</span> <span class="o">=</span> <span class="n">readDatxFile</span><span class="p">(</span><span class="n">extFnm</span><span class="p">)</span>
                <span class="n">extData</span> <span class="o">=</span> <span class="n">d</span><span class="p">[</span><span class="s1">&#39;height_nm&#39;</span><span class="p">]</span>
                <span class="n">pix_sz</span> <span class="o">=</span> <span class="p">[</span><span class="n">d</span><span class="p">[</span><span class="s1">&#39;CameraRes&#39;</span><span class="p">]</span><span class="o">*</span><span class="mf">1e3</span><span class="p">,</span><span class="n">d</span><span class="p">[</span><span class="s1">&#39;CameraRes&#39;</span><span class="p">]</span><span class="o">*</span><span class="mf">1e3</span><span class="p">]</span> <span class="c1">#mm</span>
            <span class="k">if</span> <span class="n">extFnm</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;.OPD&#39;</span><span class="p">):</span>
                <span class="n">d</span> <span class="o">=</span> <span class="n">Read_opd_file</span><span class="p">(</span><span class="n">extFnm</span><span class="p">)</span>
                <span class="n">extData</span> <span class="o">=</span> <span class="n">d</span><span class="p">[</span><span class="s1">&#39;height&#39;</span><span class="p">]</span>
                <span class="n">pix_sz</span> <span class="o">=</span> <span class="p">[</span><span class="n">d</span><span class="p">[</span><span class="s1">&#39;Pixel_size&#39;</span><span class="p">],</span><span class="n">d</span><span class="p">[</span><span class="s1">&#39;Pixel_size&#39;</span><span class="p">]]</span> <span class="c1">#mm</span>

            <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">extData</span><span class="p">):</span>
                <span class="n">iPlt</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">holdOn</span><span class="o">.</span><span class="n">isChecked</span><span class="p">():</span>
                    <span class="n">lsLgnds</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">widget</span><span class="o">.</span><span class="n">getAllImages</span><span class="p">(</span><span class="n">just_legend</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                    <span class="n">iPlt</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">lsLgnds</span><span class="p">)</span>
                <span class="n">xn</span><span class="p">,</span><span class="n">d2</span><span class="p">,</span><span class="n">dn</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">plotData</span><span class="p">(</span><span class="n">extData</span><span class="p">,</span> <span class="n">pix_sz</span><span class="o">=</span><span class="n">pix_sz</span><span class="p">,</span> <span class="n">legnd</span><span class="o">=</span><span class="n">extFnm</span><span class="p">,</span> <span class="n">iPlt</span><span class="o">=</span> <span class="n">iPlt</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">dataPlots</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s1">&#39;x&#39;</span><span class="p">:</span><span class="n">xn</span><span class="p">,</span><span class="s1">&#39;data2&#39;</span><span class="p">:</span><span class="n">d2</span><span class="p">,</span><span class="s1">&#39;dataLine&#39;</span><span class="p">:</span><span class="n">dn</span><span class="p">,</span><span class="s1">&#39;legend&#39;</span><span class="p">:</span><span class="n">extFnm</span><span class="p">,</span><span class="s1">&#39;pix_sz&#39;</span><span class="p">:</span><span class="n">pix_sz</span><span class="p">})</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;addExtSurf &lt;- Hdf5TreeViewExample&#39;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="p">)</span></div>

<div class="viewcode-block" id="Hdf5TreeViewExample.addExtCurve"><a class="viewcode-back" href="../../../PyLOSt.ui.html#PyLOSt.ui.hdf5widget_custom.Hdf5TreeViewExample.addExtCurve">[docs]</a>    <span class="k">def</span> <span class="nf">addExtCurve</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">extFnm</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">QFileDialog</span><span class="o">.</span><span class="n">getOpenFileName</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="s1">&#39;Open file&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
            <span class="c1"># initialize plots</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">initializePlotWidgets</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">extFnm</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;.slp&#39;</span><span class="p">):</span>
                <span class="n">extData</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="n">extFnm</span><span class="p">,</span> <span class="n">skiprows</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">extFnm</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;.hgt&#39;</span><span class="p">):</span>
                <span class="n">extData</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="n">extFnm</span><span class="p">,</span> <span class="n">skiprows</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>
                <span class="n">extData</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1e3</span><span class="o">*</span><span class="n">extData</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">extFnm</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;.dat&#39;</span><span class="p">):</span>
                <span class="n">extData</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="n">extFnm</span><span class="p">,</span> <span class="n">skiprows</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dType</span> <span class="o">==</span> <span class="s1">&#39;s&#39;</span><span class="p">:</span>   <span class="n">extData</span> <span class="o">=</span> <span class="n">extData</span><span class="p">[:,</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span>
                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">dType</span> <span class="o">==</span> <span class="s1">&#39;h&#39;</span><span class="p">:</span> <span class="n">extData</span> <span class="o">=</span> <span class="n">extData</span><span class="p">[:,</span><span class="mi">2</span><span class="p">:</span><span class="mi">4</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">extData</span><span class="p">):</span>
                <span class="n">x</span> <span class="o">=</span> <span class="n">extData</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">d</span> <span class="o">=</span> <span class="n">extData</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span>
                <span class="n">pz</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">extData</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]))</span>
                <span class="n">xn</span><span class="p">,</span><span class="n">d2</span><span class="p">,</span><span class="n">dn</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">plotData</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">pix_sz</span><span class="o">=</span><span class="p">[</span><span class="n">pz</span><span class="p">,</span><span class="n">pz</span><span class="p">],</span> <span class="n">legnd</span><span class="o">=</span><span class="n">extFnm</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">dataPlots</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s1">&#39;x&#39;</span><span class="p">:</span><span class="n">xn</span><span class="p">,</span><span class="s1">&#39;dataLine&#39;</span><span class="p">:</span><span class="n">dn</span><span class="p">,</span><span class="s1">&#39;legend&#39;</span><span class="p">:</span><span class="n">extFnm</span><span class="p">,</span><span class="s1">&#39;pix_sz&#39;</span><span class="p">:[</span><span class="n">pz</span><span class="p">,</span><span class="n">pz</span><span class="p">]})</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;addExtCurve &lt;- Hdf5TreeViewExample&#39;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="p">)</span></div>

<div class="viewcode-block" id="Hdf5TreeViewExample.compareResults"><a class="viewcode-back" href="../../../PyLOSt.ui.html#PyLOSt.ui.hdf5widget_custom.Hdf5TreeViewExample.compareResults">[docs]</a>    <span class="k">def</span> <span class="nf">compareResults</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Plot and compare images and/or curves. Used for comparing different stitching results</span>
<span class="sd">        :return:</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">selected</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__treeview</span><span class="o">.</span><span class="n">selectedH5Nodes</span><span class="p">())</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">pix_sz</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="c1"># initialize plots</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">initializePlotWidgets</span><span class="p">()</span>

            <span class="n">iPlt</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">holdOn</span><span class="o">.</span><span class="n">isChecked</span><span class="p">():</span>
                <span class="n">lsLgnds</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">widget</span><span class="o">.</span><span class="n">getAllImages</span><span class="p">(</span><span class="n">just_legend</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                <span class="n">iPlt</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">lsLgnds</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">iPlt</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">dataPlots</span> <span class="o">=</span> <span class="p">[]</span>

            <span class="k">for</span> <span class="n">it</span> <span class="ow">in</span> <span class="n">selected</span><span class="p">:</span>
                <span class="n">binX</span> <span class="o">=</span> <span class="mi">1</span>
                <span class="n">binY</span> <span class="o">=</span> <span class="mi">1</span>
                <span class="k">if</span> <span class="s1">&#39;scan_avg/slopes_x&#39;</span> <span class="ow">in</span> <span class="n">it</span><span class="o">.</span><span class="n">h5py_object</span><span class="p">:</span>
                    <span class="n">h5dataObj</span> <span class="o">=</span> <span class="n">it</span><span class="o">.</span><span class="n">h5py_object</span><span class="p">[</span><span class="s1">&#39;scan_avg/slopes_x&#39;</span><span class="p">]</span>
                <span class="k">elif</span> <span class="s1">&#39;scan_avg/height&#39;</span> <span class="ow">in</span> <span class="n">it</span><span class="o">.</span><span class="n">h5py_object</span><span class="p">:</span>
                    <span class="n">h5dataObj</span> <span class="o">=</span> <span class="n">it</span><span class="o">.</span><span class="n">h5py_object</span><span class="p">[</span><span class="s1">&#39;scan_avg/height&#39;</span><span class="p">]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">h5dataObj</span> <span class="o">=</span> <span class="n">it</span><span class="o">.</span><span class="n">h5py_object</span>
                <span class="k">if</span> <span class="s1">&#39;measurement_entry&#39;</span> <span class="ow">in</span> <span class="n">it</span><span class="o">.</span><span class="n">h5py_object</span><span class="p">:</span>
                    <span class="n">entryNm</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">it</span><span class="o">.</span><span class="n">h5py_object</span><span class="p">[</span><span class="s1">&#39;measurement_entry&#39;</span><span class="p">][</span><span class="o">...</span><span class="p">])</span>
                    <span class="n">pix_sz</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">h5Objs</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">entryNm</span><span class="p">][</span><span class="s1">&#39;Instrument/resolution&#39;</span><span class="p">][</span><span class="o">...</span><span class="p">]</span>
                <span class="k">if</span> <span class="s1">&#39;use_binning&#39;</span> <span class="ow">in</span> <span class="n">it</span><span class="o">.</span><span class="n">h5py_object</span><span class="o">.</span><span class="n">attrs</span><span class="p">:</span>
                    <span class="n">use_binning</span> <span class="o">=</span> <span class="n">it</span><span class="o">.</span><span class="n">h5py_object</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;use_binning&#39;</span><span class="p">][</span><span class="o">...</span><span class="p">]</span>
                    <span class="k">if</span> <span class="n">use_binning</span><span class="p">:</span>
                        <span class="n">binX</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">it</span><span class="o">.</span><span class="n">h5py_object</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;bin_size_x&#39;</span><span class="p">])</span>
                        <span class="n">binY</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">it</span><span class="o">.</span><span class="n">h5py_object</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;bin_size_y&#39;</span><span class="p">])</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">h5dataObj</span><span class="p">,</span> <span class="n">h5py</span><span class="o">.</span><span class="n">Dataset</span><span class="p">):</span>
                    <span class="n">h5data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">h5dataObj</span><span class="p">[</span><span class="o">...</span><span class="p">])</span>
                    <span class="k">if</span> <span class="s1">&#39;pix_size&#39;</span> <span class="ow">in</span> <span class="n">h5dataObj</span><span class="o">.</span><span class="n">attrs</span><span class="p">:</span>
                        <span class="n">pix_sz</span> <span class="o">=</span> <span class="n">h5dataObj</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;pix_size&#39;</span><span class="p">]</span>
                        <span class="n">pix_sz</span> <span class="o">=</span> <span class="n">getPixSz2D</span><span class="p">(</span><span class="n">pix_sz</span><span class="p">)</span>
                    <span class="k">if</span> <span class="o">~</span><span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">pix_sz</span><span class="p">):</span>
                        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">leSaveMask</span><span class="o">.</span><span class="n">text</span><span class="p">()</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">h5Objs</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
                            <span class="n">pix_sz</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">h5Objs</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="bp">self</span><span class="o">.</span><span class="n">leSaveMask</span><span class="o">.</span><span class="n">text</span><span class="p">()</span> <span class="o">+</span> <span class="s1">&#39;/Instrument/resolution&#39;</span><span class="p">][</span><span class="o">...</span><span class="p">]</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">alertMsg</span><span class="p">(</span><span class="s1">&#39;Pixel size unkown, get pixel size from entry node&#39;</span><span class="p">,</span> <span class="s1">&#39;Please select the entry node with button &quot;Get selected node&quot;&#39;</span><span class="p">)</span>
                            <span class="k">return</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">pix_sz</span> <span class="o">=</span> <span class="n">pix_sz</span>
                        
                    <span class="c1"># apply mask to output</span>
                    <span class="n">h5data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">aplyOutMask</span><span class="p">(</span><span class="n">h5dataObj</span><span class="p">,</span> <span class="n">pix_sz</span><span class="p">,</span> <span class="n">h5data</span><span class="p">)</span>
                    <span class="n">xCurv</span><span class="p">,</span><span class="n">data2</span><span class="p">,</span><span class="n">data1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">plotData</span><span class="p">(</span><span class="n">h5data</span><span class="p">,</span> <span class="n">pix_sz</span><span class="o">=</span><span class="n">pix_sz</span><span class="p">,</span> <span class="n">legnd</span> <span class="o">=</span> <span class="n">h5dataObj</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">iPlt</span><span class="o">=</span><span class="n">iPlt</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">dataPlots</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s1">&#39;x&#39;</span><span class="p">:</span><span class="n">xCurv</span><span class="p">,</span><span class="s1">&#39;data2&#39;</span><span class="p">:</span><span class="n">data2</span><span class="p">,</span><span class="s1">&#39;dataLine&#39;</span><span class="p">:</span><span class="n">data1</span><span class="p">,</span><span class="s1">&#39;iPlt&#39;</span><span class="p">:</span><span class="n">iPlt</span><span class="p">,</span><span class="s1">&#39;legend&#39;</span><span class="p">:</span><span class="n">h5dataObj</span><span class="o">.</span><span class="n">name</span><span class="p">,</span><span class="s1">&#39;pix_sz&#39;</span><span class="p">:</span><span class="n">pix_sz</span><span class="p">})</span>
                    <span class="n">iPlt</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;compareResults &lt;- Hdf5TreeViewExample&#39;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">widget</span><span class="o">.</span><span class="n">setKeepDataAspectRatio</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span></div>

<div class="viewcode-block" id="Hdf5TreeViewExample.plotData"><a class="viewcode-back" href="../../../PyLOSt.ui.html#PyLOSt.ui.hdf5widget_custom.Hdf5TreeViewExample.plotData">[docs]</a>    <span class="k">def</span> <span class="nf">plotData</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">h5data</span><span class="p">,</span> <span class="n">pix_sz</span><span class="p">,</span> <span class="n">legnd</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">binX</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">binY</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">iPlt</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">h5data</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">flipData</span><span class="o">.</span><span class="n">isChecked</span><span class="p">():</span>
                <span class="n">h5data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">flip</span><span class="p">(</span><span class="n">h5data</span><span class="p">,</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
                <span class="n">h5data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">flip</span><span class="p">(</span><span class="n">h5data</span><span class="p">,</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">2</span><span class="p">)</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dType</span> <span class="o">==</span> <span class="s1">&#39;s&#39;</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">isStd</span><span class="o">.</span><span class="n">isChecked</span><span class="p">():</span> <span class="n">h5data</span> <span class="o">=</span> <span class="o">-</span><span class="n">h5data</span>
            <span class="n">h5dataResd</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">center</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">h5data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
            <span class="n">xCurv</span> <span class="o">=</span> <span class="n">pix_sz</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">binX</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">h5data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
            <span class="n">xCurv</span> <span class="o">=</span> <span class="n">xCurv</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">xCurv</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">isGravityCor</span><span class="o">.</span><span class="n">isChecked</span><span class="p">():</span>  <span class="c1"># correct for gravity</span>
                <span class="n">gx</span> <span class="o">=</span> <span class="n">gravity_correction</span><span class="p">(</span><span class="n">xCurv</span><span class="p">,</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">leMirThickness</span><span class="o">.</span><span class="n">text</span><span class="p">()),</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">leMirLen</span><span class="o">.</span><span class="n">text</span><span class="p">()),</span>
                                        <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">leCylDist</span><span class="o">.</span><span class="n">text</span><span class="p">()))</span> <span class="o">*</span> <span class="mf">1e3</span>  <span class="c1"># mrad to urad</span>
                <span class="n">h5data</span> <span class="o">=</span> <span class="n">h5data</span> <span class="o">+</span> <span class="n">gx</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">remPoly</span><span class="o">.</span><span class="n">isChecked</span><span class="p">():</span>
                <span class="n">deg</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">remPolyDeg</span><span class="o">.</span><span class="n">text</span><span class="p">())</span>
                <span class="n">C</span><span class="p">,</span> <span class="n">h5dataResd</span><span class="p">,</span> <span class="n">h5fit</span> <span class="o">=</span> <span class="n">fit2D</span><span class="p">(</span><span class="n">h5data</span><span class="p">,</span> <span class="n">pix_size</span><span class="o">=</span><span class="n">pix_sz</span><span class="p">,</span> <span class="n">degree</span><span class="o">=</span><span class="n">deg</span><span class="p">,</span> <span class="n">useMaskForXY</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
                <span class="n">Cc</span><span class="p">,</span> <span class="n">curvData</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">fit1D</span><span class="p">(</span><span class="n">h5data</span><span class="p">[</span><span class="n">center</span><span class="p">],</span> <span class="n">pix_size</span><span class="o">=</span><span class="n">pix_sz</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">degree</span><span class="o">=</span><span class="n">deg</span><span class="p">)</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dType</span> <span class="o">==</span> <span class="s1">&#39;h&#39;</span> <span class="ow">and</span> <span class="n">deg</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                    <span class="n">legnd</span> <span class="o">=</span> <span class="n">legnd</span> <span class="o">+</span> <span class="s1">&#39; - Rc = &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">around</span><span class="p">(</span><span class="mf">0.5</span> <span class="o">*</span> <span class="mi">1000</span> <span class="o">/</span> <span class="n">Cc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">decimals</span><span class="o">=</span><span class="mi">3</span><span class="p">))</span> <span class="o">+</span> <span class="s1">&#39; m, rms = &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">around</span><span class="p">(</span><span class="n">rms</span><span class="p">(</span><span class="n">curvData</span><span class="p">),</span> <span class="n">decimals</span><span class="o">=</span><span class="mi">3</span><span class="p">))</span> <span class="o">+</span> <span class="s1">&#39; nm&#39;</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Rc (2D) = &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="mf">0.5</span> <span class="o">*</span> <span class="mi">1000</span> <span class="o">/</span> <span class="n">C</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="s1">&#39; m&#39;</span><span class="p">)</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dType</span> <span class="o">==</span> <span class="s1">&#39;s&#39;</span> <span class="ow">and</span> <span class="n">deg</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="n">legnd</span> <span class="o">=</span> <span class="n">legnd</span> <span class="o">+</span> <span class="s1">&#39; - Rc = &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">around</span><span class="p">(</span><span class="mi">1000</span> <span class="o">/</span> <span class="n">Cc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">decimals</span><span class="o">=</span><span class="mi">3</span><span class="p">))</span> <span class="o">+</span> <span class="s1">&#39; m, rms = &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">around</span><span class="p">(</span><span class="n">rms</span><span class="p">(</span><span class="n">curvData</span><span class="p">),</span> <span class="n">decimals</span><span class="o">=</span><span class="mi">3</span><span class="p">))</span> <span class="o">+</span> <span class="s1">&#39; urad&#39;</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Rc (2D) = &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="mi">1000</span> <span class="o">/</span> <span class="n">C</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="s1">&#39; m&#39;</span><span class="p">)</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">remEl</span><span class="o">.</span><span class="n">isChecked</span><span class="p">():</span>
                <span class="n">p</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">elP</span><span class="o">.</span><span class="n">text</span><span class="p">())</span>
                <span class="n">q</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">elQ</span><span class="o">.</span><span class="n">text</span><span class="p">())</span>
                <span class="n">th</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">elTheta</span><span class="o">.</span><span class="n">text</span><span class="p">())</span>
                <span class="n">S</span> <span class="o">=</span> <span class="n">remEllipseData</span><span class="p">(</span><span class="n">h5data</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="n">p</span><span class="p">,</span> <span class="n">q</span><span class="o">=</span><span class="n">q</span><span class="p">,</span> <span class="n">theta</span><span class="o">=</span><span class="n">th</span><span class="p">,</span> <span class="n">pixSize</span><span class="o">=</span><span class="n">pix_sz</span><span class="p">,</span> <span class="n">dataType</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dType</span><span class="p">,</span> <span class="n">optimizeType</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fitType</span><span class="p">,</span> <span class="n">line</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">selLine</span><span class="o">.</span><span class="n">text</span><span class="p">())</span>
                <span class="n">h5dataResd</span> <span class="o">=</span> <span class="n">S</span><span class="p">[</span><span class="s1">&#39;se&#39;</span><span class="p">]</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dType</span><span class="o">==</span><span class="s1">&#39;s&#39;</span> <span class="k">else</span> <span class="n">S</span><span class="p">[</span><span class="s1">&#39;ze&#39;</span><span class="p">]</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dType</span><span class="o">==</span><span class="s1">&#39;h&#39;</span> <span class="k">else</span> <span class="n">h5data</span>
                <span class="n">curvData</span> <span class="o">=</span> <span class="n">S</span><span class="p">[</span><span class="s1">&#39;lse&#39;</span><span class="p">]</span>
                <span class="c1"># legnd = legnd + &#39; , q = &#39; + str(S[&#39;q&#39;]) + &#39; , theta = &#39; + str(S[&#39;theta&#39;]) + &#39; , dq = &#39; + str(S[&#39;dq&#39;]) + &#39; , dtheta = &#39; + str(S[&#39;dtheta&#39;])</span>
                <span class="n">legnd</span> <span class="o">=</span> <span class="n">legnd</span> <span class="o">+</span><span class="s1">&#39;, rms:&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">rms</span><span class="p">(</span><span class="n">S</span><span class="p">[</span><span class="s1">&#39;lse&#39;</span><span class="p">]))</span><span class="o">+</span><span class="s1">&#39; urad, dq = &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">S</span><span class="p">[</span><span class="s1">&#39;dq&#39;</span><span class="p">])</span> <span class="o">+</span> <span class="s1">&#39; , dtheta = &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">S</span><span class="p">[</span><span class="s1">&#39;dtheta&#39;</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">plot_h</span><span class="o">.</span><span class="n">addCurve</span><span class="p">(</span><span class="n">S</span><span class="p">[</span><span class="s1">&#39;xc&#39;</span><span class="p">],</span> <span class="n">scipy</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">detrend</span><span class="p">(</span><span class="n">S</span><span class="p">[</span><span class="s1">&#39;lhe&#39;</span><span class="p">]),</span> <span class="n">legend</span><span class="o">=</span><span class="n">legnd</span><span class="p">,</span> <span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;X (mm)&#39;</span><span class="p">,</span>
                                     <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;Height errors (nm)&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">addCurve</span><span class="p">(</span><span class="n">S</span><span class="p">[</span><span class="s1">&#39;xc&#39;</span><span class="p">],</span> <span class="n">S</span><span class="p">[</span><span class="s1">&#39;lse&#39;</span><span class="p">],</span> <span class="n">legend</span><span class="o">=</span><span class="n">legnd</span><span class="p">,</span> <span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;X (mm)&#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;Slope errors (urad)&#39;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">h5dataResd</span> <span class="o">=</span> <span class="n">h5data</span>
                <span class="n">curvData</span> <span class="o">=</span> <span class="n">h5data</span><span class="p">[</span><span class="n">center</span><span class="p">]</span>

            <span class="c1"># h5dataResd = h5dataResd  # -np.nanmean(h5dataResd.flatten())</span>
            <span class="n">sh</span> <span class="o">=</span> <span class="n">h5dataResd</span><span class="o">.</span><span class="n">shape</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;rms h5dataResd: &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">rms</span><span class="p">(</span><span class="n">h5dataResd</span><span class="p">)))</span>
            <span class="n">dispOffsetScale</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dispOffset</span><span class="o">.</span><span class="n">text</span><span class="p">())</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">widget</span><span class="o">.</span><span class="n">addImage</span><span class="p">(</span><span class="n">h5dataResd</span><span class="p">,</span> <span class="n">colormap</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">colormap</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="n">legnd</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="p">(</span>
            <span class="o">-</span><span class="n">sh</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">binX</span> <span class="o">*</span> <span class="n">pix_sz</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="p">(</span><span class="o">-</span><span class="n">sh</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">iPlt</span> <span class="o">*</span> <span class="p">(</span><span class="n">sh</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">dispOffsetScale</span><span class="p">))</span> <span class="o">*</span> <span class="n">binY</span> <span class="o">*</span> <span class="n">pix_sz</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span>
                                 <span class="n">scale</span><span class="o">=</span><span class="p">(</span><span class="n">pix_sz</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">binX</span><span class="p">,</span> <span class="n">pix_sz</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">binY</span><span class="p">),</span> <span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;X (mm)&#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;Y (mm)&#39;</span><span class="p">)</span>
            <span class="c1"># wid = self.getNewWidget()</span>
            <span class="c1"># wid.addImage(h5dataResd, legend=h5dataObj.name, replace=False, origin=(-sh[1]*binX*pix_sz[0]/2, (-sh[0]/2+i*(sh[0]*1.2))*binY*pix_sz[1]),</span>
            <span class="c1">#                       scale=(pix_sz[0]*binX, pix_sz[1]*binY), xlabel=&#39;X (mm)&#39;, ylabel=&#39;Y (mm)&#39;)</span>
            <span class="c1"># wid.setGraphTitle(h5dataObj.name)</span>
            <span class="c1"># wid.setWindowTitle(&#39;&#39;)</span>

            <span class="n">ylb</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dType</span> <span class="o">==</span> <span class="s1">&#39;h&#39;</span><span class="p">:</span>
                <span class="n">ylb</span> <span class="o">=</span> <span class="s1">&#39;Height errors (nm)&#39;</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">isStd</span><span class="o">.</span><span class="n">isChecked</span><span class="p">():</span> <span class="n">ylb</span> <span class="o">=</span> <span class="s1">&#39;Height std (nm)&#39;</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">dType</span> <span class="o">==</span> <span class="s1">&#39;s&#39;</span><span class="p">:</span>
                <span class="n">ylb</span> <span class="o">=</span> <span class="s1">&#39;Slope errors (urad)&#39;</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">isStd</span><span class="o">.</span><span class="n">isChecked</span><span class="p">():</span> <span class="n">ylb</span> <span class="o">=</span> <span class="s1">&#39;Slope std (urad)&#39;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">widget</span><span class="o">.</span><span class="n">setGraphTitle</span><span class="p">(</span><span class="n">ylb</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">remEl</span><span class="o">.</span><span class="n">isChecked</span><span class="p">():</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">addCurve</span><span class="p">(</span><span class="n">xCurv</span><span class="p">,</span> <span class="n">curvData</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="n">legnd</span><span class="p">,</span> <span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;X (mm)&#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="n">ylb</span><span class="p">)</span>
            <span class="c1"># self.__dataViewer.setData(h5dataResd) # this is replacing the original stitched result</span>

        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">h5data</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">h5dataResd</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">flipData</span><span class="o">.</span><span class="n">isChecked</span><span class="p">():</span>
                <span class="n">h5data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">flip</span><span class="p">(</span><span class="n">h5data</span><span class="p">,</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dType</span> <span class="o">==</span> <span class="s1">&#39;s&#39;</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">isStd</span><span class="o">.</span><span class="n">isChecked</span><span class="p">():</span> <span class="n">h5data</span> <span class="o">=</span> <span class="o">-</span><span class="n">h5data</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">remPoly</span><span class="o">.</span><span class="n">isChecked</span><span class="p">():</span>
                <span class="n">deg</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">remPolyDeg</span><span class="o">.</span><span class="n">text</span><span class="p">())</span>
                <span class="n">Cc</span><span class="p">,</span> <span class="n">curvData</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">fit1D</span><span class="p">(</span><span class="n">h5data</span><span class="p">,</span> <span class="n">pix_size</span><span class="o">=</span><span class="n">pix_sz</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">degree</span><span class="o">=</span><span class="n">deg</span><span class="p">)</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dType</span> <span class="o">==</span> <span class="s1">&#39;h&#39;</span> <span class="ow">and</span> <span class="n">deg</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>  <span class="n">legnd</span> <span class="o">=</span> <span class="n">legnd</span> <span class="o">+</span> <span class="s1">&#39; - Rc = &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">around</span><span class="p">(</span><span class="mf">0.5</span> <span class="o">*</span> <span class="mi">1000</span> <span class="o">/</span> <span class="n">Cc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">decimals</span><span class="o">=</span><span class="mi">3</span><span class="p">))</span> <span class="o">+</span> <span class="s1">&#39; m, rms = &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span>
                    <span class="n">np</span><span class="o">.</span><span class="n">around</span><span class="p">(</span><span class="n">rms</span><span class="p">(</span><span class="n">curvData</span><span class="p">),</span> <span class="n">decimals</span><span class="o">=</span><span class="mi">3</span><span class="p">))</span> <span class="o">+</span> <span class="s1">&#39; nm&#39;</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dType</span> <span class="o">==</span> <span class="s1">&#39;s&#39;</span> <span class="ow">and</span> <span class="n">deg</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>  <span class="n">legnd</span> <span class="o">=</span> <span class="n">legnd</span> <span class="o">+</span> <span class="s1">&#39; - Rc = &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">around</span><span class="p">(</span><span class="mi">1000</span> <span class="o">/</span> <span class="n">Cc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">decimals</span><span class="o">=</span><span class="mi">3</span><span class="p">))</span> <span class="o">+</span> <span class="s1">&#39; m, rms = &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span>
                    <span class="n">np</span><span class="o">.</span><span class="n">around</span><span class="p">(</span><span class="n">rms</span><span class="p">(</span><span class="n">curvData</span><span class="p">),</span> <span class="n">decimals</span><span class="o">=</span><span class="mi">3</span><span class="p">))</span> <span class="o">+</span> <span class="s1">&#39; urad&#39;</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">remEl</span><span class="o">.</span><span class="n">isChecked</span><span class="p">():</span>
                <span class="n">p</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">elP</span><span class="o">.</span><span class="n">text</span><span class="p">())</span>
                <span class="n">q</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">elQ</span><span class="o">.</span><span class="n">text</span><span class="p">())</span>
                <span class="n">th</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">elTheta</span><span class="o">.</span><span class="n">text</span><span class="p">())</span>
                <span class="n">xc</span> <span class="o">=</span> <span class="n">pix_sz</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">h5data</span><span class="p">))</span>
                <span class="n">xc</span> <span class="o">=</span> <span class="n">xc</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">xc</span><span class="p">)</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dType</span> <span class="o">==</span> <span class="s1">&#39;s&#39;</span><span class="p">:</span>
                    <span class="n">S</span> <span class="o">=</span> <span class="n">remEllipseLine</span><span class="p">(</span><span class="n">xc</span><span class="p">,</span> <span class="n">sx</span><span class="o">=</span><span class="n">h5data</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="n">p</span><span class="p">,</span> <span class="n">q</span><span class="o">=</span><span class="n">q</span><span class="p">,</span> <span class="n">theta</span><span class="o">=</span><span class="n">th</span><span class="p">,</span> <span class="n">dataType</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dType</span><span class="p">,</span> <span class="n">optimizeType</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fitType</span><span class="p">)</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dType</span> <span class="o">==</span> <span class="s1">&#39;h&#39;</span><span class="p">:</span>
                    <span class="n">S</span> <span class="o">=</span> <span class="n">remEllipseLine</span><span class="p">(</span><span class="n">xc</span><span class="p">,</span> <span class="n">z</span><span class="o">=</span><span class="n">h5data</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="n">p</span><span class="p">,</span> <span class="n">q</span><span class="o">=</span><span class="n">q</span><span class="p">,</span> <span class="n">theta</span><span class="o">=</span><span class="n">th</span><span class="p">,</span> <span class="n">dataType</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dType</span><span class="p">,</span> <span class="n">optimizeType</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fitType</span><span class="p">)</span>

                <span class="n">curvData</span> <span class="o">=</span> <span class="n">S</span><span class="p">[</span><span class="s1">&#39;lse&#39;</span><span class="p">]</span>
                <span class="n">legnd</span> <span class="o">=</span> <span class="n">legnd</span> <span class="o">+</span><span class="s1">&#39;, rms:&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">rms</span><span class="p">(</span><span class="n">S</span><span class="p">[</span><span class="s1">&#39;lse&#39;</span><span class="p">]))</span><span class="o">+</span><span class="s1">&#39; urad, dq = &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">S</span><span class="p">[</span><span class="s1">&#39;dq&#39;</span><span class="p">])</span> <span class="o">+</span> <span class="s1">&#39; , dtheta = &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">S</span><span class="p">[</span><span class="s1">&#39;dtheta&#39;</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">plot_h</span><span class="o">.</span><span class="n">addCurve</span><span class="p">(</span><span class="n">S</span><span class="p">[</span><span class="s1">&#39;xc&#39;</span><span class="p">],</span> <span class="n">scipy</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">detrend</span><span class="p">(</span><span class="n">S</span><span class="p">[</span><span class="s1">&#39;lhe&#39;</span><span class="p">]),</span> <span class="n">legend</span><span class="o">=</span><span class="n">legnd</span><span class="p">,</span> <span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;X (mm)&#39;</span><span class="p">,</span>
                                     <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;Height errors (nm)&#39;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">curvData</span> <span class="o">=</span> <span class="n">h5data</span>
            <span class="n">xCurv</span> <span class="o">=</span> <span class="n">pix_sz</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">binX</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">curvData</span><span class="p">))</span>
            <span class="n">xCurv</span> <span class="o">=</span> <span class="n">xCurv</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">xCurv</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">addCurve</span><span class="p">(</span><span class="n">xCurv</span><span class="p">,</span> <span class="n">curvData</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="n">legnd</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">xCurv</span><span class="p">,</span> <span class="n">h5dataResd</span><span class="p">,</span> <span class="n">curvData</span></div>

<div class="viewcode-block" id="Hdf5TreeViewExample.aplyOutMask"><a class="viewcode-back" href="../../../PyLOSt.ui.html#PyLOSt.ui.hdf5widget_custom.Hdf5TreeViewExample.aplyOutMask">[docs]</a>    <span class="k">def</span> <span class="nf">aplyOutMask</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">h5dataObj</span><span class="p">,</span> <span class="n">pix_sz</span><span class="p">,</span> <span class="n">h5data</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Apply output mask if present. Used on stitched data before plotting</span>

<span class="sd">        :param h5dataObj: Stitched data group object</span>
<span class="sd">        :param pix_sz: Pixel size</span>
<span class="sd">        :param h5data: Data to apply mask</span>
<span class="sd">        :return: Masked data</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="s1">&#39;output_mask&#39;</span> <span class="ow">in</span> <span class="n">h5dataObj</span><span class="o">.</span><span class="n">parent</span><span class="p">:</span>
            <span class="n">mask</span> <span class="o">=</span> <span class="n">h5dataObj</span><span class="o">.</span><span class="n">parent</span><span class="p">[</span><span class="s1">&#39;output_mask&#39;</span><span class="p">][</span><span class="o">...</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">bool</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">mask</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="n">h5data</span><span class="o">.</span><span class="n">ndim</span><span class="p">:</span>    <span class="n">h5data</span><span class="p">[</span><span class="o">~</span><span class="n">mask</span><span class="p">]</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">xlim</span><span class="o">.</span><span class="n">isChecked</span><span class="p">():</span>
            <span class="n">xmin</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">minX</span><span class="o">.</span><span class="n">text</span><span class="p">())</span>
            <span class="n">xmax</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">maxX</span><span class="o">.</span><span class="n">text</span><span class="p">())</span>
            <span class="n">x_mm</span> <span class="o">=</span> <span class="n">pix_sz</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">h5data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
            <span class="n">x_mm</span> <span class="o">=</span> <span class="n">x_mm</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">x_mm</span><span class="p">)</span>    
            <span class="n">q</span> <span class="o">=</span> <span class="p">(</span><span class="n">x_mm</span><span class="o">&gt;</span><span class="n">xmin</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">x_mm</span><span class="o">&lt;</span><span class="n">xmax</span><span class="p">)</span>
            <span class="n">qmask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">h5data</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;byte&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
            <span class="n">qmask</span> <span class="o">=</span> <span class="n">qmask</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">bool</span><span class="p">)</span>
            <span class="n">h5data</span><span class="p">[</span><span class="o">~</span><span class="n">qmask</span><span class="p">]</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span>
        <span class="k">return</span> <span class="n">h5data</span></div>

<div class="viewcode-block" id="Hdf5TreeViewExample.getNewWidget"><a class="viewcode-back" href="../../../PyLOSt.ui.html#PyLOSt.ui.hdf5widget_custom.Hdf5TreeViewExample.getNewWidget">[docs]</a>    <span class="k">def</span> <span class="nf">getNewWidget</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">colormap</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;jet&#39;</span><span class="p">,</span> <span class="s1">&#39;normalization&#39;</span><span class="p">:</span> <span class="s1">&#39;linear&#39;</span><span class="p">,</span>
            <span class="s1">&#39;autoscale&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s1">&#39;vmin&#39;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span> <span class="s1">&#39;vmax&#39;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">}</span>
        <span class="n">widget</span> <span class="o">=</span> <span class="n">Plot2D</span><span class="p">()</span>
        <span class="n">widget</span><span class="o">.</span><span class="n">setDefaultColormap</span><span class="p">(</span><span class="n">colormap</span><span class="p">)</span>
        <span class="n">widget</span><span class="o">.</span><span class="n">setKeepDataAspectRatio</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">widget</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;wids&#39;</span><span class="p">)</span>  <span class="ow">or</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">holdOn</span><span class="o">.</span><span class="n">isChecked</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">wids</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">wids</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">widget</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">widget</span></div>

<div class="viewcode-block" id="Hdf5TreeViewExample.initializePlotWidgets"><a class="viewcode-back" href="../../../PyLOSt.ui.html#PyLOSt.ui.hdf5widget_custom.Hdf5TreeViewExample.initializePlotWidgets">[docs]</a>    <span class="k">def</span> <span class="nf">initializePlotWidgets</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initialize plot widgets for comparing stitched results</span>
<span class="sd">        :return:</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">colormap</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;jet&#39;</span><span class="p">,</span> <span class="s1">&#39;normalization&#39;</span><span class="p">:</span> <span class="s1">&#39;linear&#39;</span><span class="p">,</span>
            <span class="s1">&#39;autoscale&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s1">&#39;vmin&#39;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span> <span class="s1">&#39;vmax&#39;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">}</span>
        
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="s1">&#39;plot&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">holdOn</span><span class="o">.</span><span class="n">isChecked</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">plot</span> <span class="o">=</span> <span class="n">Plot1D</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="s1">&#39;widget&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">holdOn</span><span class="o">.</span><span class="n">isChecked</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">widget</span> <span class="o">=</span> <span class="n">Plot2D</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">widget</span><span class="o">.</span><span class="n">setDefaultColormap</span><span class="p">(</span><span class="n">colormap</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">widget</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">remEl</span><span class="o">.</span><span class="n">isChecked</span><span class="p">():</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;plot_h&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">holdOn</span><span class="o">.</span><span class="n">isChecked</span><span class="p">():</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">plot_h</span> <span class="o">=</span> <span class="n">Plot1D</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">plot_h</span><span class="o">.</span><span class="n">setGraphTitle</span><span class="p">(</span><span class="s1">&#39;Height errors/best fit ellipse&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">plot_h</span><span class="o">.</span><span class="n">show</span><span class="p">()</span></div>
            
<div class="viewcode-block" id="Hdf5TreeViewExample.stitchData"><a class="viewcode-back" href="../../../PyLOSt.ui.html#PyLOSt.ui.hdf5widget_custom.Hdf5TreeViewExample.stitchData">[docs]</a>    <span class="k">def</span> <span class="nf">stitchData</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Call the relevant stitching algorithm</span>
<span class="sd">        :return:</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">selected</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__treeview</span><span class="o">.</span><span class="n">selectedH5Nodes</span><span class="p">())</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">selected</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="c1"># Update the viewer for a single selection</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">selected</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">if</span> <span class="s1">&#39;stitch_algorithm&#39;</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">h5py_object</span><span class="p">:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">owStitch</span><span class="o">.</span><span class="n">isChecked</span><span class="p">():</span> <span class="c1">#if checked delete any existing stitched data in this version</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">delStitchGroups</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">h5py_object</span><span class="p">)</span>
                <span class="n">aname</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">h5py_object</span><span class="p">[</span><span class="s1">&#39;stitch_algorithm&#39;</span><span class="p">][</span><span class="o">...</span><span class="p">])</span>
                <span class="n">svname</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">h5py_object</span><span class="o">.</span><span class="n">name</span>
                <span class="n">mainH5</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">h5Objs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">aname</span> <span class="o">==</span> <span class="s1">&#39;simple_avg&#39;</span><span class="p">:</span>
                    <span class="n">sa</span> <span class="o">=</span> <span class="n">SimpleAverage</span><span class="p">(</span><span class="n">mainH5</span><span class="p">,</span><span class="n">svname</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">aname</span> <span class="o">==</span> <span class="s1">&#39;prog_stitch&#39;</span><span class="p">:</span>
                    <span class="n">sa</span> <span class="o">=</span> <span class="n">ProgressiveStitch</span><span class="p">(</span><span class="n">mainH5</span><span class="p">,</span><span class="n">svname</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">aname</span> <span class="o">==</span> <span class="s1">&#39;matrix_overlaperr&#39;</span><span class="p">:</span>
                    <span class="n">sa</span> <span class="o">=</span> <span class="n">MatrixOverlapErrStitchFast</span><span class="p">(</span><span class="n">mainH5</span><span class="p">,</span> <span class="n">svname</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">aname</span> <span class="o">==</span> <span class="s1">&#39;global_optimize&#39;</span><span class="p">:</span>
                    <span class="n">sa</span> <span class="o">=</span> <span class="n">GlobalOptimizationFast</span><span class="p">(</span><span class="n">mainH5</span><span class="p">,</span> <span class="n">svname</span><span class="p">)</span>
                <span class="n">exclTxt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">leExcludePatches</span><span class="o">.</span><span class="n">text</span><span class="p">()</span>
                <span class="n">nbExclPatches</span> <span class="o">=</span> <span class="mi">0</span> <span class="k">if</span> <span class="n">exclTxt</span><span class="o">==</span><span class="s1">&#39;&#39;</span> <span class="k">else</span> <span class="nb">int</span><span class="p">(</span><span class="n">exclTxt</span><span class="p">)</span>
                <span class="n">sa</span><span class="o">.</span><span class="n">stitch</span><span class="p">(</span><span class="n">nbExclPatches</span> <span class="o">=</span> <span class="n">nbExclPatches</span><span class="p">,</span> <span class="n">quserstr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">avgSelStr</span><span class="o">.</span><span class="n">text</span><span class="p">())</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">syncH5Obj</span><span class="p">(</span><span class="n">h5Obj</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">h5py_object</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">alertMsg</span><span class="p">(</span><span class="s1">&#39;Select stitch setup&#39;</span><span class="p">,</span> <span class="s1">&#39;Please select a stitching setup&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">alertMsg</span><span class="p">(</span><span class="s1">&#39;Select stitch setup&#39;</span><span class="p">,</span> <span class="s1">&#39;Please select a stitching setup&#39;</span><span class="p">)</span></div>
    
<div class="viewcode-block" id="Hdf5TreeViewExample.delStitchGroups"><a class="viewcode-back" href="../../../PyLOSt.ui.html#PyLOSt.ui.hdf5widget_custom.Hdf5TreeViewExample.delStitchGroups">[docs]</a>    <span class="k">def</span> <span class="nf">delStitchGroups</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">h5stitch</span><span class="p">):</span>
        <span class="k">if</span> <span class="s1">&#39;stitched_scans&#39;</span> <span class="ow">in</span> <span class="n">h5stitch</span><span class="p">:</span>        <span class="k">del</span> <span class="n">h5stitch</span><span class="p">[</span><span class="s1">&#39;stitched_scans&#39;</span><span class="p">]</span>
        <span class="k">if</span> <span class="s1">&#39;scan_avg&#39;</span> <span class="ow">in</span> <span class="n">h5stitch</span><span class="p">:</span>            <span class="k">del</span> <span class="n">h5stitch</span><span class="p">[</span><span class="s1">&#39;scan_avg&#39;</span><span class="p">]</span></div></div>

<div class="viewcode-block" id="main"><a class="viewcode-back" href="../../../PyLOSt.ui.html#PyLOSt.ui.hdf5widget_custom.main">[docs]</a><span class="k">def</span> <span class="nf">main</span><span class="p">(</span><span class="n">filenames</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    :param filenames: list of file paths</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">app</span> <span class="o">=</span> <span class="n">qt</span><span class="o">.</span><span class="n">QApplication</span><span class="p">([])</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">excepthook</span> <span class="o">=</span> <span class="n">qt</span><span class="o">.</span><span class="n">exceptionHandler</span>
    <span class="n">connectDB</span><span class="p">()</span>
    <span class="n">window</span> <span class="o">=</span> <span class="n">Hdf5TreeViewExample</span><span class="p">(</span><span class="n">filenames</span><span class="p">)</span>
    <span class="n">window</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">app</span><span class="o">.</span><span class="n">exec_</span><span class="p">()</span>
    <span class="c1"># remove ending warnings relative to QTimer</span>
    <span class="n">app</span><span class="o">.</span><span class="n">deleteLater</span><span class="p">()</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="n">result</span><span class="p">)</span></div>

</pre></div>

          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../../../index.html">PyLOSt</a></h1>








<h3>Navigation</h3>
<p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../PyLOSt.html">PyLOSt package</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../quick_guide.html">Quick Guide</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../../index.html">Documentation overview</a><ul>
  <li><a href="../../index.html">Module code</a><ul>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2022, Author.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 4.2.0</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
    </div>

    

    
  </body>
</html>